<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Fine-mapping example • susieR</title>
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fine-mapping example">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">susieR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.14.21</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/finemapping.html" aria-label="Get started with susieR"><span class="fa fa-play-circle"></span> Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html" aria-label="Function reference"><span class="fa fa-file-code"></span> Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html" aria-label="Articles and vignettes"><span class="fa fa-book-reader"></span> Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html" aria-label="Package news"><span class="fa fa-newspaper"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stephenslab/susieR" aria-label="View source on GitHub"><span class="fa fab fa-github"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fine-mapping example</h1>
                        <h4 data-toc-skip class="author">Gao Wang</h4>
            
            <h4 data-toc-skip class="date">2025-09-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stephenslab/susieR/blob/HEAD/vignettes/finemapping.Rmd" class="external-link"><code>vignettes/finemapping.Rmd</code></a></small>
      <div class="d-none name"><code>finemapping.Rmd</code></div>
    </div>

    
    
<p>This vignette demonstrates <code>susieR</code> in the context of
genetic fine-mapping. We use simulated data of expression level of a
gene (<span class="math inline">y</span>) in <span class="math inline">N
\approx 600</span> individuals. We want to identify with the genotype
matrix <span class="math inline">X_{N\times P}</span> (<span class="math inline">P=1001</span>) the genetic variables that causes
changes in expression level.</p>
<p>The simulated data set is simulated to have exactly 3 non-zero
effects.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stephenslab/susieR" class="external-link">susieR</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="the-data-set">The data-set<a class="anchor" aria-label="anchor" href="#the-data-set"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">N3finemapping</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">N3finemapping</span><span class="op">)</span></span></code></pre></div>
<p>The loaded dataset contains regression data <span class="math inline">X</span> and <span class="math inline">y</span>,
along with some other relevant properties in the context of genetic
studies. It also contains the “true” regression coefficent the data is
simulated from.</p>
<p>Notice that we’ve simulated 2 sets of <span class="math inline">Y</span> as 2 simulation replicates. Here we’ll
focus on the first data-set.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span>
<span><span class="co"># [1] 574   2</span></span></code></pre></div>
<p>Here are the 3 “true” signals in the first data-set:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="va">true_coef</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span>, pch<span class="op">=</span><span class="fl">16</span>, ylab<span class="op">=</span><span class="st">'effect size'</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="finemapping_files/figure-html/unnamed-chunk-4-1.png" alt="&amp;nbsp;" width="600"><p class="caption">
 
</p>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">b</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co"># [1] 403 653 773</span></span></code></pre></div>
<p>So the underlying causal variables are 403, 653 and 773.</p>
</div>
<div class="section level2">
<h2 id="simple-regression-summary-statistics">Simple regression summary statistics<a class="anchor" aria-label="anchor" href="#simple-regression-summary-statistics"></a>
</h2>
<p><code>univariate_regression</code> function can be used to compute
summary statistics by fitting univariate simple regression variable by
variable. The results are <span class="math inline">\hat{\beta}</span>
and <span class="math inline">SE(\hat{\beta})</span> from which z-scores
can be derived. Again we focus only on results from the first
data-set:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sumstats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/univariate_regression.html">univariate_regression</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">z_scores</span> <span class="op">&lt;-</span> <span class="va">sumstats</span><span class="op">$</span><span class="va">betahat</span> <span class="op">/</span> <span class="va">sumstats</span><span class="op">$</span><span class="va">sebetahat</span></span>
<span><span class="fu"><a href="../reference/susie_plots.html">susie_plot</a></span><span class="op">(</span><span class="va">z_scores</span>, y <span class="op">=</span> <span class="st">"z"</span>, b<span class="op">=</span><span class="va">b</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="finemapping_files/figure-html/unnamed-chunk-6-1.png" alt="&amp;nbsp;" width="600"><p class="caption">
 
</p>
</div>
</div>
<div class="section level2">
<h2 id="fine-mapping-with-susier">Fine-mapping with <code>susieR</code><a class="anchor" aria-label="anchor" href="#fine-mapping-with-susier"></a>
</h2>
<p>For starters, we assume there are at most 10 causal variables, i.e.,
set <code>L = 10</code>, although SuSiE is robust to the choice of
<code>L</code>.</p>
<p>The <code>susieR</code> function call is:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/susie.html">susie</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>                L <span class="op">=</span> <span class="fl">10</span>,</span>
<span>        verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># [1] "objective:-1377.48646000795"</span></span>
<span><span class="co"># [1] "objective:-1375.80877379734"</span></span>
<span><span class="co"># [1] "objective:-1370.19662361075"</span></span>
<span><span class="co"># [1] "objective:-1370.10903101489"</span></span></code></pre></div>
<div class="section level3">
<h3 id="credible-sets">Credible sets<a class="anchor" aria-label="anchor" href="#credible-sets"></a>
</h3>
<p>By default, we output 95% credible set:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fitted</span><span class="op">$</span><span class="va">sets</span><span class="op">)</span></span>
<span><span class="co"># $cs</span></span>
<span><span class="co"># $cs$L2</span></span>
<span><span class="co"># [1] 653</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $cs$L1</span></span>
<span><span class="co"># [1] 773 777</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $cs$L3</span></span>
<span><span class="co">#  [1] 362 365 372 373 374 379 381 383 384 386 387 388 389 391 392 396 397 398 399</span></span>
<span><span class="co"># [20] 400 401 403 404 405 407 408 415</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $purity</span></span>
<span><span class="co">#    min.abs.corr mean.abs.corr median.abs.corr</span></span>
<span><span class="co"># L2    1.0000000     1.0000000       1.0000000</span></span>
<span><span class="co"># L1    0.9815726     0.9815726       0.9815726</span></span>
<span><span class="co"># L3    0.8686309     0.9640176       0.9720711</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $cs_index</span></span>
<span><span class="co"># [1] 2 1 3</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $coverage</span></span>
<span><span class="co"># [1] 0.9998236 0.9988858 0.9539811</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $requested_coverage</span></span>
<span><span class="co"># [1] 0.95</span></span></code></pre></div>
<p>The 3 causal signals have been captured by the 3 CS reported here.
The 3rd CS contains many variables, including the true causal variable
<code>403</code>. The minimum absolute correlation is 0.86.</p>
<p>If we use the default 90% coverage for credible sets, we still
capture the 3 signals, but “purity” of the 3rd CS is now 0.91 and size
of the CS is also a bit smaller.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/susie_get_methods.html">susie_get_cs</a></span><span class="op">(</span><span class="va">fitted</span>,</span>
<span>                     X <span class="op">=</span> <span class="va">X</span>,</span>
<span>             coverage <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>                     min_abs_corr <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sets</span><span class="op">)</span></span>
<span><span class="co"># $cs</span></span>
<span><span class="co"># $cs$L2</span></span>
<span><span class="co"># [1] 653</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $cs$L1</span></span>
<span><span class="co"># [1] 773 777</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $cs$L3</span></span>
<span><span class="co">#  [1] 373 374 379 381 383 384 386 387 388 389 391 392 396 398 399 400 401 403 404</span></span>
<span><span class="co"># [20] 405 407 408</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $purity</span></span>
<span><span class="co">#    min.abs.corr mean.abs.corr median.abs.corr</span></span>
<span><span class="co"># L2    1.0000000     1.0000000       1.0000000</span></span>
<span><span class="co"># L1    0.9815726     0.9815726       0.9815726</span></span>
<span><span class="co"># L3    0.9119572     0.9726283       0.9765888</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $cs_index</span></span>
<span><span class="co"># [1] 2 1 3</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $coverage</span></span>
<span><span class="co"># [1] 0.9998236 0.9988858 0.9119917</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $requested_coverage</span></span>
<span><span class="co"># [1] 0.9</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="posterior-inclusion-probabilities">Posterior inclusion probabilities<a class="anchor" aria-label="anchor" href="#posterior-inclusion-probabilities"></a>
</h3>
<p>Previously we’ve determined that summing over 3 single effect
regression models is approperate for our application. Here we summarize
the variable selection results by posterior inclusion probability
(PIP):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/susie_plots.html">susie_plot</a></span><span class="op">(</span><span class="va">fitted</span>, y<span class="op">=</span><span class="st">"PIP"</span>, b<span class="op">=</span><span class="va">b</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="finemapping_files/figure-html/unnamed-chunk-11-1.png" alt="&amp;nbsp;" width="600"><p class="caption">
 
</p>
</div>
<p>The true causal variables are colored red. The 95% CS identified are
circled in different colors. Of interest is the cluster around position
400. The true signal is 403 but apparently it does not have the highest
PIP. To compare ranking of PIP and original z-score in that CS:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span>  <span class="op">&lt;-</span> <span class="va">fitted</span><span class="op">$</span><span class="va">sets</span><span class="op">$</span><span class="va">cs</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">z3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">i</span>,<span class="va">z_scores</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">fitted</span><span class="op">$</span><span class="va">pip</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">z3</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'position'</span>, <span class="st">'z-score'</span>, <span class="st">'PIP'</span><span class="op">)</span></span>
<span><span class="va">z3</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">z3</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="co">#       position  z-score         PIP</span></span>
<span><span class="co">#  [1,]      396 5.189811 0.056704331</span></span>
<span><span class="co">#  [2,]      381 5.164794 0.100360243</span></span>
<span><span class="co">#  [3,]      386 5.164794 0.100360243</span></span>
<span><span class="co">#  [4,]      379 5.077563 0.054179507</span></span>
<span><span class="co">#  [5,]      391 5.068388 0.055952118</span></span>
<span><span class="co">#  [6,]      383 5.057053 0.052896918</span></span>
<span><span class="co">#  [7,]      384 5.057053 0.052896918</span></span>
<span><span class="co">#  [8,]      389 5.052519 0.042161265</span></span>
<span><span class="co">#  [9,]      405 5.039617 0.045761975</span></span>
<span><span class="co"># [10,]      403 5.035949 0.031992848</span></span>
<span><span class="co"># [11,]      387 5.013526 0.041041505</span></span>
<span><span class="co"># [12,]      388 4.997955 0.039650079</span></span>
<span><span class="co"># [13,]      408 4.994865 0.041551961</span></span>
<span><span class="co"># [14,]      404 4.954407 0.032013339</span></span>
<span><span class="co"># [15,]      374 4.948060 0.030571484</span></span>
<span><span class="co"># [16,]      373 4.934410 0.023577221</span></span>
<span><span class="co"># [17,]      362 4.894243 0.012145481</span></span>
<span><span class="co"># [18,]      399 4.860780 0.026454056</span></span>
<span><span class="co"># [19,]      392 4.856384 0.019741011</span></span>
<span><span class="co"># [20,]      407 4.849285 0.014699313</span></span>
<span><span class="co"># [21,]      400 4.827361 0.021659443</span></span>
<span><span class="co"># [22,]      365 4.782770 0.006263425</span></span>
<span><span class="co"># [23,]      398 4.751205 0.012907848</span></span>
<span><span class="co"># [24,]      401 4.723184 0.014858460</span></span>
<span><span class="co"># [25,]      397 4.716886 0.008690915</span></span>
<span><span class="co"># [26,]      415 4.663208 0.009003129</span></span>
<span><span class="co"># [27,]      372 4.581560 0.005886458</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="choice-of-priors">Choice of priors<a class="anchor" aria-label="anchor" href="#choice-of-priors"></a>
</h3>
<p>Notice that by default SuSiE estimates prior effect size from data.
For fine-mapping applications, however, we sometimes have knowledge of
SuSiE prior effect size since it is parameterized as percentage of
variance explained (PVE) by a non-zero effect, which, in the context of
fine-mapping, is related to per-SNP heritability. It is possible to use
<code>scaled_prior_variance</code> to specify this PVE and explicitly
set <code>estimate_prior_variance=FALSE</code> to fix the prior effect
to given value.</p>
<p>In this data-set, SuSiE is robust to choice of priors. Here we set
PVE to 0.2, and compare with previous results:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitted</span> <span class="op">=</span> <span class="fu"><a href="../reference/susie.html">susie</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>               L <span class="op">=</span> <span class="fl">10</span>,</span>
<span>               estimate_residual_variance <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>               estimate_prior_variance <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>               scaled_prior_variance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/susie_plots.html">susie_plot</a></span><span class="op">(</span><span class="va">fitted</span>, y<span class="op">=</span><span class="st">'PIP'</span>, b<span class="op">=</span><span class="va">b</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="finemapping_files/figure-html/unnamed-chunk-13-1.png" alt="&amp;nbsp;" width="600"><p class="caption">
 
</p>
</div>
<p>which largely remains unchanged.</p>
</div>
<div class="section level3">
<h3 id="a-note-on-covariate-adjustment">A note on covariate adjustment<a class="anchor" aria-label="anchor" href="#a-note-on-covariate-adjustment"></a>
</h3>
<p>To include covariate <code>Z</code> in SuSiE, one approach is to
regress it out from both <code>y</code> and <code>X</code>, and then run
SuSiE on the residuals. The code below illustrates the procedure:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">remove.covariate.effects</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">X</span>, <span class="va">Z</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># include the intercept term</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">Z</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">!=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="va">Z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Z</span><span class="op">)</span></span>
<span>  <span class="va">A</span>   <span class="op">&lt;-</span> <span class="fu">forceSymmetric</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">SZy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">A</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">Z</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">SZX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">A</span>,<span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">X</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Z</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">SZy</span><span class="op">)</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op">-</span> <span class="va">Z</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">SZX</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">X</span>,y <span class="op">=</span> <span class="va">y</span>,SZy <span class="op">=</span> <span class="va">SZy</span>,SZX <span class="op">=</span> <span class="va">SZX</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">out</span> <span class="op">=</span> <span class="fu">remove.covariate.effects</span><span class="op">(</span><span class="va">X</span>, <span class="va">Z</span>, <span class="va">Y</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">fitted_adjusted</span> <span class="op">=</span> <span class="fu"><a href="../reference/susie.html">susie</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">X</span>, <span class="va">out</span><span class="op">$</span><span class="va">y</span>, L <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>Note that the covariates <code>Z</code> should have a column of ones
as the first column. If not, the above function
<code>remove.covariate.effects</code> will add such a column to
<code>Z</code> before regressing it out. Data will be centered as a
result. Also the scale of data is changed after regressing out
<code>Z</code>. This introduces some subtleties in terms of interpreting
the results. For this reason, we provide covariate adjustment procedure
as a tip in the documentation and not part of
<code><a href="../reference/susie.html">susieR::susie()</a></code> function. Cautions should be taken when
applying this procedure and interpreting the result from it.</p>
</div>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<p>Here are some details about the computing environment, including the
versions of R, and the R packages, used to generate these results.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># R version 4.4.3 (2025-02-28)</span></span>
<span><span class="co"># Platform: x86_64-conda-linux-gnu</span></span>
<span><span class="co"># Running under: Linux Mint 22</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Matrix products: default</span></span>
<span><span class="co"># BLAS/LAPACK: /home/gw/.pixi/envs/r-base/lib/libopenblasp-r0.3.30.so;  LAPACK version 3.12.0</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># locale:</span></span>
<span><span class="co">#  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co"># [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># time zone: America/New_York</span></span>
<span><span class="co"># tzcode source: system (glibc)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># attached base packages:</span></span>
<span><span class="co"># [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># other attached packages:</span></span>
<span><span class="co"># [1] susieR_0.14.21</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># loaded via a namespace (and not attached):</span></span>
<span><span class="co">#  [1] Matrix_1.7-3       gtable_0.3.6       jsonlite_2.0.0     dplyr_1.1.4       </span></span>
<span><span class="co">#  [5] compiler_4.4.3     crayon_1.5.3       Rcpp_1.1.0         tidyselect_1.2.1  </span></span>
<span><span class="co">#  [9] parallel_4.4.3     jquerylib_0.1.4    systemfonts_1.2.3  scales_1.4.0      </span></span>
<span><span class="co"># [13] textshaping_1.0.1  yaml_2.3.10        fastmap_1.2.0      lattice_0.22-7    </span></span>
<span><span class="co"># [17] plyr_1.8.9         ggplot2_3.5.2      R6_2.6.1           generics_0.1.4    </span></span>
<span><span class="co"># [21] mixsqp_0.3-54      knitr_1.50         htmlwidgets_1.6.4  tibble_3.3.0      </span></span>
<span><span class="co"># [25] desc_1.4.3         RcppZiggurat_0.1.8 bslib_0.9.0        pillar_1.11.0     </span></span>
<span><span class="co"># [29] RColorBrewer_1.1-3 rlang_1.1.6        reshape_0.8.9      cachem_1.1.0      </span></span>
<span><span class="co"># [33] xfun_0.52          fs_1.6.6           sass_0.4.10        RcppParallel_5.1.9</span></span>
<span><span class="co"># [37] cli_3.6.5          pkgdown_2.1.3      magrittr_2.0.3     digest_0.6.37     </span></span>
<span><span class="co"># [41] grid_4.4.3         irlba_2.3.5.1      lifecycle_1.0.4    vctrs_0.6.5       </span></span>
<span><span class="co"># [45] Rfast_2.1.0        evaluate_1.0.4     glue_1.8.0         farver_2.1.2      </span></span>
<span><span class="co"># [49] ragg_1.4.0         rmarkdown_2.29     matrixStats_1.5.0  tools_4.4.3       </span></span>
<span><span class="co"># [53] pkgconfig_2.0.3    htmltools_0.5.8.1</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gao Wang, Yuxin Zou, Kaiqian Zhang, William R.P. Denault, Peter Carbonetto, Matthew Stephens.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
