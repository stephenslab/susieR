<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bayesian sum of single-effect (susie) linear regression using summary stat — susie_ss • susieR</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Bayesian sum of single-effect (susie) linear regression using summary stat — susie_ss" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">susieR</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/stephenslab/susieR">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bayesian sum of single-effect (susie) linear regression using summary stat</h1>
    
    <div class="hidden name"><code>susie_ss.Rd</code></div>
    </div>

    <div class="ref-description">

    </div>

    <pre class="usage"><span class='fu'>susie_ss</span>(<span class='no'>XtX</span>, <span class='no'>XtY</span>, <span class='kw'>var_y</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>n</span>, <span class='kw'>L</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>prior_variance</span> <span class='kw'>=</span> <span class='fl'>0.2</span>,
  <span class='kw'>residual_variance</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>estimate_prior_variance</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>max_iter</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>s_init</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>intercept</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>1e-04</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>XtX</th>
      <td><p>a p by p matrix, X'X, where columns of X are centered to have mean 0</p></td>
    </tr>
    <tr>
      <th>XtY</th>
      <td><p>a p vector, X'Y, where columns of X are centered and Y is centered to have mean 0</p></td>
    </tr>
    <tr>
      <th>var_y</th>
      <td><p>the (sample) variance of the vector Y</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>sample size</p></td>
    </tr>
    <tr>
      <th>L</th>
      <td><p>maximum number of non-zero effects</p></td>
    </tr>
    <tr>
      <th>prior_variance</th>
      <td><p>the scaled prior variance (vector of length L, or scalar. In latter case gets repeated L times )</p></td>
    </tr>
    <tr>
      <th>residual_variance</th>
      <td><p>the residual variance (defaults to variance of Y)</p></td>
    </tr>
    <tr>
      <th>estimate_prior_variance</th>
      <td><p>indicates whether to estimate prior (currently not recommended as not working as well)</p></td>
    </tr>
    <tr>
      <th>max_iter</th>
      <td><p>maximum number of iterations to perform</p></td>
    </tr>
    <tr>
      <th>s_init</th>
      <td><p>a previous susie fit with which to initialize</p></td>
    </tr>
    <tr>
      <th>intercept</th>
      <td><p>a value to assign to the intercept (since the intercept cannot be estimated from centered summary data). This
value will be used by coef.susie() to assign an intercept value, for consistency with the non-summary-statistic version of this function <code>susie</code>.
Set to NULL if you want coef.susie() not to include an intercept term (and so only return a p vector).</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>convergence tolerance based on alpha</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a susie fit, which is a list with some or all of the following elements<br /></p>
<dt>alpha</dt><dd><p>an L by p matrix of posterior inclusion probabilites</p></dd>
<dt>mu</dt><dd><p>an L by p matrix of posterior means (conditional on inclusion)</p></dd>
<dt>mu2</dt><dd><p>an L by p matrix of posterior second moments (conditional on inclusion)</p></dd>
<dt>XtXr</dt><dd><p>an p vector of t(X) times fitted values, the fitted values equal to X times colSums(alpha*mu))</p></dd>
<dt>sigma2</dt><dd><p>residual variance</p></dd>
<dt>sa2</dt><dd><p>scaled prior variance; ie prior variance is sigma2*sa2</p></dd>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Performs sum of single-effect (susie) linear regression of Y on X when
only summary statistics are available. The summary data required are
the p by p matrix X'X, the p vector X'Y, and the sample variance of Y, or (1/n)Y'Y. The summary stats should come from the same individuals.
Both the columns of X and the vector Y
should be centered to have mean 0 before
computing these summary statistics; you may also want to scale each column of X and Y to have variance 1 (see examples).
This function fits the regression model Y = sum_l Xb_l + e, where elements of e are iid N(0,var=residual_variance) and the
sum_l b_l is a p vector of effects to be estimated.
The assumption is that each b_l has exactly one non-zero element, with all elements
equally likely to be non-zero. The prior on the non-zero element is N(0,var=prior_variance*residual_variance).</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='fu'>set.seed</span>(<span class='fl'>1</span>)
<span class='no'>n</span> <span class='kw'>=</span> <span class='fl'>1000</span>
<span class='no'>p</span> <span class='kw'>=</span> <span class='fl'>1000</span>
<span class='no'>beta</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>0</span>,<span class='no'>p</span>)
<span class='no'>beta</span>[<span class='fl'>1</span>] <span class='kw'>=</span> <span class='fl'>1</span>
<span class='no'>beta</span>[<span class='fl'>2</span>] <span class='kw'>=</span> <span class='fl'>1</span>
<span class='no'>beta</span>[<span class='fl'>3</span>] <span class='kw'>=</span> <span class='fl'>1</span>
<span class='no'>beta</span>[<span class='fl'>4</span>] <span class='kw'>=</span> <span class='fl'>1</span>
<span class='no'>X</span> <span class='kw'>=</span> <span class='fu'>matrix</span>(<span class='fu'>rnorm</span>(<span class='no'>n</span>*<span class='no'>p</span>),<span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>n</span>,<span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>p</span>)
<span class='no'>y</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='no'>X</span> <span class='kw'>%*%</span> <span class='no'>beta</span> + <span class='fu'>rnorm</span>(<span class='no'>n</span>))
<span class='no'>X</span> <span class='kw'>=</span> <span class='fu'>scale</span>(<span class='no'>X</span>,<span class='kw'>center</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>scale</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>y</span> <span class='kw'>=</span> (<span class='no'>y</span> - <span class='fu'>mean</span>(<span class='no'>y</span>))/<span class='fu'>sd</span>(<span class='no'>y</span>)
<span class='no'>res</span> <span class='kw'>=</span><span class='fu'>susie_ss</span>(<span class='kw'>XtX</span><span class='kw'>=</span><span class='fu'>t</span>(<span class='no'>X</span>) <span class='kw'>%*%</span> <span class='no'>X</span>,<span class='kw'>XtY</span><span class='kw'>=</span> <span class='fu'>c</span>(<span class='no'>y</span> <span class='kw'>%*%</span> <span class='no'>X</span>), <span class='fl'>1</span>)
<span class='fu'>coef</span>(<span class='no'>res</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Matthew Stephens, Yuxin Zou, Peter Carbonetto, Gao Wang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

