<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Apply susie to trend filtering (especially changepoint problems), a type of non-parametric regression. — susie_trendfilter • susieR</title><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Apply susie to trend filtering (especially changepoint problems), a type of non-parametric regression. — susie_trendfilter"><meta name="description" content='Fits the non-parametric Gaussian regression model
  \(y = mu + e\), where the mean \(mu\) is modelled as \(mu =
  Xb\), X is a matrix with columns containing an appropriate basis,
  and b is vector with a (sparse) SuSiE prior. In particular, when
  order = 0, the jth column of X is a vector with the first j
  elements equal to zero, and the remaining elements equal to 1, so
  that \(b_j\) corresponds to the change in the mean of y between
  indices j and j+1. For background on trend filtering, see
  Tibshirani (2014). See also the "Trend filtering" vignette,
  vignette("trend_filtering").'><meta property="og:description" content='Fits the non-parametric Gaussian regression model
  \(y = mu + e\), where the mean \(mu\) is modelled as \(mu =
  Xb\), X is a matrix with columns containing an appropriate basis,
  and b is vector with a (sparse) SuSiE prior. In particular, when
  order = 0, the jth column of X is a vector with the first j
  elements equal to zero, and the remaining elements equal to 1, so
  that \(b_j\) corresponds to the change in the mean of y between
  indices j and j+1. For background on trend filtering, see
  Tibshirani (2014). See also the "Trend filtering" vignette,
  vignette("trend_filtering").'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">susieR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.14.21</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/finemapping.html" aria-label="Get started with susieR"><span class="fa fa-play-circle"></span> Get Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html" aria-label="Function reference"><span class="fa fa-file-code"></span> Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html" aria-label="Articles and vignettes"><span class="fa fa-book-reader"></span> Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html" aria-label="Package news"><span class="fa fa-newspaper"></span> News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stephenslab/susieR" aria-label="View source on GitHub"><span class="fa fab fa-github"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Apply susie to trend filtering (especially changepoint problems), a type of non-parametric regression.</h1>
      <small class="dont-index">Source: <a href="https://github.com/stephenslab/susieR/blob/HEAD/R/susie_trendfilter.R" class="external-link"><code>R/susie_trendfilter.R</code></a></small>
      <div class="d-none name"><code>susie_trendfilter.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits the non-parametric Gaussian regression model
  \(y = mu + e\), where the mean \(mu\) is modelled as \(mu =
  Xb\), X is a matrix with columns containing an appropriate basis,
  and b is vector with a (sparse) SuSiE prior. In particular, when
  <code>order = 0</code>, the jth column of X is a vector with the first j
  elements equal to zero, and the remaining elements equal to 1, so
  that \(b_j\) corresponds to the change in the mean of y between
  indices j and j+1. For background on trend filtering, see
  Tibshirani (2014). See also the "Trend filtering" vignette,
  <code><a href="../articles/trend_filtering.html">vignette("trend_filtering")</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">susie_trendfilter</span><span class="op">(</span><span class="va">y</span>, order <span class="op">=</span> <span class="fl">0</span>, standardize <span class="op">=</span> <span class="cn">FALSE</span>, use_mad <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>An n-vector of observations ordered in time or space
(assumed to be equally spaced).</p></dd>


<dt id="arg-order">order<a class="anchor" aria-label="anchor" href="#arg-order"></a></dt>
<dd><p>An integer specifying the order of trend filtering.
The default, <code>order = 0</code>, corresponds to "changepoint"
problems (<em>i.e.</em>, piecewise constant \(mu\)). Although
<code>order &gt; 0</code> is implemented, we do not recommend its use; in
practice, we have found problems with convergence of the algorithm
to poor local optima, producing unreliable inferences.</p></dd>


<dt id="arg-standardize">standardize<a class="anchor" aria-label="anchor" href="#arg-standardize"></a></dt>
<dd><p>Logical indicating whether to standardize the X
variables ("basis functions"); <code>standardize = FALSE</code> is
recommended as these basis functions already have a natural scale.</p></dd>


<dt id="arg-use-mad">use_mad<a class="anchor" aria-label="anchor" href="#arg-use-mad"></a></dt>
<dd><p>Logical indicating whether to use the "median
absolute deviation" (MAD) method to the estimate residual
variance. If <code>use_mad = TRUE</code>, susie is run twice, first by
fixing the residual variance to the MAD value, then a second time,
initialized to the first fit, but with residual variance estimated
the usual way (by maximizing the ELBO). We have found this strategy
typically improves reliability of the results by reducing a
tendency to converge to poor local optima of the ELBO.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed to <code><a href="susie.html">susie</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A "susie" fit; see <code><a href="susie.html">susie</a></code> for details.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This implementation exploits the special structure of X,
  which means that the matrix-vector product \(X^Ty\) is fast to
  compute; in particular, the computation time is \(O(n)\) rather
  than \(O(n^2)\) if <code>X</code> were formed explicitly. For
  implementation details, see the "Implementation of SuSiE trend
  filtering" vignette by running
  <code>vignette("trendfiltering_derivations")</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>R. J. Tibshirani (2014). Adaptive piecewise polynomial
  estimation via trend filtering. <em>Annals of Statistics</em>
  <b>42</b>, 285-323.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">50</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">50</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">50</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">=</span> <span class="va">mu</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">400</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">=</span> <span class="fu">susie_trendfilter</span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">mu</span>,col <span class="op">=</span> <span class="fl">1</span>,lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span>,col <span class="op">=</span> <span class="fl">2</span>,lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="susie_trendfilter-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate credible sets (indices of y that occur just before</span></span></span>
<span class="r-in"><span><span class="co"># changepoints).</span></span></span>
<span class="r-in"><span><span class="fu"><a href="susie_get_methods.html">susie_get_cs</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cs$L1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cs$L2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 45 46 47 48 49 50 51 52 53 54 55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cs$L4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 199 200 201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cs$L6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  99 100 101 102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $coverage</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9882895 0.9608400 0.9866788 0.9584016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $requested_coverage</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot with credible sets for changepoints.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="susie_plot_changepoint.html">susie_plot_changepoint</a></span><span class="op">(</span><span class="va">s</span>,<span class="va">y</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="susie_trendfilter-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gao Wang, Yuxin Zou, Kaiqian Zhang, William R.P. Denault, Peter Carbonetto, Matthew Stephens.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

