[{"path":"https://stephenslab.github.io/susieR/articles/finemapping.html","id":"the-data-set","dir":"Articles","previous_headings":"","what":"The data-set","title":"Fine-mapping example","text":"loaded dataset contains regression data X y, along relevant properties context genetic studies. also contains “true” regression coefficent data simulated . Notice ’ve simulated 2 sets Y 2 simulation replicates. ’ll focus first data-set. 3 “true” signals first data-set:   underlying causal variables 403, 653 773.","code":"data(N3finemapping) attach(N3finemapping) dim(Y) # [1] 574   2 b <- true_coef[,1] plot(b, pch=16, ylab='effect size') which(b != 0) # [1] 403 653 773"},{"path":"https://stephenslab.github.io/susieR/articles/finemapping.html","id":"simple-regression-summary-statistics","dir":"Articles","previous_headings":"","what":"Simple regression summary statistics","title":"Fine-mapping example","text":"univariate_regression function can used compute summary statistics fitting univariate simple regression variable variable. results \\hat{\\beta} SE(\\hat{\\beta}) z-scores can derived. focus results first data-set:  ","code":"sumstats <- univariate_regression(X, Y[,1]) z_scores <- sumstats$betahat / sumstats$sebetahat susie_plot(z_scores, y = \"z\", b=b)"},{"path":"https://stephenslab.github.io/susieR/articles/finemapping.html","id":"fine-mapping-with-susier","dir":"Articles","previous_headings":"","what":"Fine-mapping with susieR","title":"Fine-mapping example","text":"starters, assume 10 causal variables, .e., set L = 10, although SuSiE robust choice L. susieR function call :","code":"fitted <- susie(X, Y[,1],                 L = 10,         verbose = TRUE) # [1] \"objective:-1377.48646000795\" # [1] \"objective:-1375.80877379734\" # [1] \"objective:-1370.19662361075\" # [1] \"objective:-1370.10903101489\""},{"path":"https://stephenslab.github.io/susieR/articles/finemapping.html","id":"credible-sets","dir":"Articles","previous_headings":"Fine-mapping with susieR","what":"Credible sets","title":"Fine-mapping example","text":"default, output 95% credible set: 3 causal signals captured 3 CS reported . 3rd CS contains many variables, including true causal variable 403. minimum absolute correlation 0.86. use default 90% coverage credible sets, still capture 3 signals, “purity” 3rd CS now 0.91 size CS also bit smaller.","code":"print(fitted$sets) # $cs # $cs$L2 # [1] 653 #  # $cs$L1 # [1] 773 777 #  # $cs$L3 #  [1] 362 365 372 373 374 379 381 383 384 386 387 388 389 391 392 396 397 398 399 # [20] 400 401 403 404 405 407 408 415 #  #  # $purity #    min.abs.corr mean.abs.corr median.abs.corr # L2    1.0000000     1.0000000       1.0000000 # L1    0.9815726     0.9815726       0.9815726 # L3    0.8686309     0.9640176       0.9720711 #  # $cs_index # [1] 2 1 3 #  # $coverage # [1] 0.9998236 0.9988858 0.9539811 #  # $requested_coverage # [1] 0.95 sets <- susie_get_cs(fitted,                      X = X,              coverage = 0.9,                      min_abs_corr = 0.1) print(sets) # $cs # $cs$L2 # [1] 653 #  # $cs$L1 # [1] 773 777 #  # $cs$L3 #  [1] 373 374 379 381 383 384 386 387 388 389 391 392 396 398 399 400 401 403 404 # [20] 405 407 408 #  #  # $purity #    min.abs.corr mean.abs.corr median.abs.corr # L2    1.0000000     1.0000000       1.0000000 # L1    0.9815726     0.9815726       0.9815726 # L3    0.9119572     0.9726283       0.9765888 #  # $cs_index # [1] 2 1 3 #  # $coverage # [1] 0.9998236 0.9988858 0.9119917 #  # $requested_coverage # [1] 0.9"},{"path":"https://stephenslab.github.io/susieR/articles/finemapping.html","id":"posterior-inclusion-probabilities","dir":"Articles","previous_headings":"Fine-mapping with susieR","what":"Posterior inclusion probabilities","title":"Fine-mapping example","text":"Previously ’ve determined summing 3 single effect regression models approperate application. summarize variable selection results posterior inclusion probability (PIP):   true causal variables colored red. 95% CS identified circled different colors. interest cluster around position 400. true signal 403 apparently highest PIP. compare ranking PIP original z-score CS:","code":"susie_plot(fitted, y=\"PIP\", b=b) i  <- fitted$sets$cs[[3]] z3 <- cbind(i,z_scores[i],fitted$pip[i]) colnames(z3) <- c('position', 'z-score', 'PIP') z3[order(z3[,2], decreasing = TRUE),] #       position  z-score         PIP #  [1,]      396 5.189811 0.056704331 #  [2,]      381 5.164794 0.100360243 #  [3,]      386 5.164794 0.100360243 #  [4,]      379 5.077563 0.054179507 #  [5,]      391 5.068388 0.055952118 #  [6,]      383 5.057053 0.052896918 #  [7,]      384 5.057053 0.052896918 #  [8,]      389 5.052519 0.042161265 #  [9,]      405 5.039617 0.045761975 # [10,]      403 5.035949 0.031992848 # [11,]      387 5.013526 0.041041505 # [12,]      388 4.997955 0.039650079 # [13,]      408 4.994865 0.041551961 # [14,]      404 4.954407 0.032013339 # [15,]      374 4.948060 0.030571484 # [16,]      373 4.934410 0.023577221 # [17,]      362 4.894243 0.012145481 # [18,]      399 4.860780 0.026454056 # [19,]      392 4.856384 0.019741011 # [20,]      407 4.849285 0.014699313 # [21,]      400 4.827361 0.021659443 # [22,]      365 4.782770 0.006263425 # [23,]      398 4.751205 0.012907848 # [24,]      401 4.723184 0.014858460 # [25,]      397 4.716886 0.008690915 # [26,]      415 4.663208 0.009003129 # [27,]      372 4.581560 0.005886458"},{"path":"https://stephenslab.github.io/susieR/articles/finemapping.html","id":"choice-of-priors","dir":"Articles","previous_headings":"Fine-mapping with susieR","what":"Choice of priors","title":"Fine-mapping example","text":"Notice default SuSiE estimates prior effect size data. fine-mapping applications, however, sometimes knowledge SuSiE prior effect size since parameterized percentage variance explained (PVE) non-zero effect, , context fine-mapping, related per-SNP heritability. possible use scaled_prior_variance specify PVE explicitly set estimate_prior_variance=FALSE fix prior effect given value. data-set, SuSiE robust choice priors. set PVE 0.2, compare previous results:   largely remains unchanged.","code":"fitted = susie(X, Y[,1],                L = 10,                estimate_residual_variance = TRUE,                 estimate_prior_variance = FALSE,                 scaled_prior_variance = 0.2) susie_plot(fitted, y='PIP', b=b)"},{"path":"https://stephenslab.github.io/susieR/articles/finemapping.html","id":"a-note-on-covariate-adjustment","dir":"Articles","previous_headings":"Fine-mapping with susieR","what":"A note on covariate adjustment","title":"Fine-mapping example","text":"include covariate Z SuSiE, one approach regress y X, run SuSiE residuals. code illustrates procedure: Note covariates Z column ones first column. , function remove.covariate.effects add column Z regressing . Data centered result. Also scale data changed regressing Z. introduces subtleties terms interpreting results. reason, provide covariate adjustment procedure tip documentation part susieR::susie() function. Cautions taken applying procedure interpreting result .","code":"remove.covariate.effects <- function (X, Z, y) {   # include the intercept term   if (any(Z[,1]!=1)) Z = cbind(1, Z)   A   <- forceSymmetric(crossprod(Z))   SZy <- as.vector(solve(A,c(y %*% Z)))   SZX <- as.matrix(solve(A,t(Z) %*% X))   y <- y - c(Z %*% SZy)   X <- X - Z %*% SZX   return(list(X = X,y = y,SZy = SZy,SZX = SZX)) }  out = remove.covariate.effects(X, Z, Y[,1]) fitted_adjusted = susie(out$X, out$y, L = 10)"},{"path":"https://stephenslab.github.io/susieR/articles/finemapping.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"Fine-mapping example","text":"details computing environment, including versions R, R packages, used generate results.","code":"sessionInfo() # R version 4.4.3 (2025-02-28) # Platform: x86_64-conda-linux-gnu # Running under: Linux Mint 22 #  # Matrix products: default # BLAS/LAPACK: /home/gw/.pixi/envs/r-base/lib/libopenblasp-r0.3.30.so;  LAPACK version 3.12.0 #  # locale: #  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               #  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     #  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    #  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  #  [9] LC_ADDRESS=C               LC_TELEPHONE=C             # [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        #  # time zone: America/New_York # tzcode source: system (glibc) #  # attached base packages: # [1] stats     graphics  grDevices utils     datasets  methods   base      #  # other attached packages: # [1] susieR_0.14.21 #  # loaded via a namespace (and not attached): #  [1] Matrix_1.7-3       gtable_0.3.6       jsonlite_2.0.0     dplyr_1.1.4        #  [5] compiler_4.4.3     crayon_1.5.3       Rcpp_1.1.0         tidyselect_1.2.1   #  [9] parallel_4.4.3     jquerylib_0.1.4    systemfonts_1.2.3  scales_1.4.0       # [13] textshaping_1.0.1  yaml_2.3.10        fastmap_1.2.0      lattice_0.22-7     # [17] plyr_1.8.9         ggplot2_3.5.2      R6_2.6.1           generics_0.1.4     # [21] mixsqp_0.3-54      knitr_1.50         htmlwidgets_1.6.4  tibble_3.3.0       # [25] desc_1.4.3         RcppZiggurat_0.1.8 bslib_0.9.0        pillar_1.11.0      # [29] RColorBrewer_1.1-3 rlang_1.1.6        reshape_0.8.9      cachem_1.1.0       # [33] xfun_0.52          fs_1.6.6           sass_0.4.10        RcppParallel_5.1.9 # [37] cli_3.6.5          pkgdown_2.1.3      magrittr_2.0.3     digest_0.6.37      # [41] grid_4.4.3         irlba_2.3.5.1      lifecycle_1.0.4    vctrs_0.6.5        # [45] Rfast_2.1.0        evaluate_1.0.4     glue_1.8.0         farver_2.1.2       # [49] ragg_1.4.0         rmarkdown_2.29     matrixStats_1.5.0  tools_4.4.3        # [53] pkgconfig_2.0.3    htmltools_0.5.8.1"},{"path":"https://stephenslab.github.io/susieR/articles/finemapping_summary_statistics.html","id":"the-data-set","dir":"Articles","previous_headings":"","what":"The data-set","title":"Fine-mapping with summary statistics","text":"Notice ’ve simulated two sets Y two simulation replicates. ’ll focus first data-set. three true signals first data-set:   underlying causal variables 403, 653 773.","code":"data(N3finemapping) attach(N3finemapping) n = nrow(X) dim(Y) # [1] 574   2 b <- true_coef[,1] plot(b, pch=16, ylab='effect size') which(b != 0) # [1] 403 653 773"},{"path":"https://stephenslab.github.io/susieR/articles/finemapping_summary_statistics.html","id":"summary-statistics-from-simple-regression","dir":"Articles","previous_headings":"","what":"Summary statistics from simple regression","title":"Fine-mapping with summary statistics","text":"Summary statistics genetic association studies typically contain effect sizes (\\hat{\\beta} coefficient regression) p-values. statisticscan used perform fine-mapping given additional input correlation matrix variables. correlation matrix genetics typically referred “LD matrix” (LD short linkage disequilibrium). One may use external reference panels estimate matrix obtained samples directly. Importantly, LD matrix matrix containing estimates correlation, r, r^2 |r|. See also vignette check consistency LD matrix summary statistics. univariate_regression function can used compute summary statistics fitting univariate simple regression variable variable. results \\hat{\\beta} SE(\\hat{\\beta}) z-scores can derived. Alternatively, can obtain z-scores \\hat{\\beta} p-values provided information. example,   example, correlation matrix can computed directly data provided:","code":"sumstats <- univariate_regression(X, Y[,1]) z_scores <- sumstats$betahat / sumstats$sebetahat susie_plot(z_scores, y = \"z\", b=b) R <- cor(X)"},{"path":"https://stephenslab.github.io/susieR/articles/finemapping_summary_statistics.html","id":"fine-mapping-with-susier-using-summary-statistics","dir":"Articles","previous_headings":"","what":"Fine-mapping with susieR using summary statistics","title":"Fine-mapping with summary statistics","text":"default, SuSiE assumes 10 causal variables, L = 10, although note SuSiE generally robust choice L. Since individual-level data available us , can easily compute “-sample LD” matrix, well variance y, 7.8424. (“-sample”, means LD computed exact matrix X used obtain statistics.) fit SuSiE regression summary statistics, \\hat{\\beta}, SE(\\hat{\\beta}), R, n, var_y also sufficient statistics. -sample LD, can also estimate residual variance using sufficient statistics. (Note covariate effects removed genotypes univariate regression, recommended “-sample” LD matrix also computed genotypes covariate effects removed.) Using summary, can examine posterior inclusion probability (PIP) variable, 95% credible sets: three causal signals captured three CSs. Note third CS contains many variables, including true causal variable 403. can also plot posterior inclusion probabilities (PIPs):   true causal variables shown red. 95% CSs shown three different colours (green, purple, blue). Note result exactly running susie original individual-level data: , hand, variance y unknown, fit can SuSiE regression summary statistics, \\hat{\\beta}, SE(\\hat{\\beta}), R n (z-scores, R n). outputted effect estimates now standardized X y scale. Still, can estimate residual variance -sample LD matrix: result run susie individual-level data, output effect estimates different scale:   Specifically, without variance y, estimates applied SuSiE standardized X y; , y columns X normalized y column X standard deviation 1.","code":"fitted_rss1 <- susie_rss(bhat = sumstats$betahat, shat = sumstats$sebetahat, n = n, R = R, var_y = var(Y[,1]), L = 10,                          estimate_residual_variance = TRUE) # HINT: For estimate_residual_variance = TRUE, please check that R is the \"in-sample\" LD matrix; that is, the correlation matrix obtained using the exact same data matrix X that was used for the other summary statistics. Also note, when covariates are included in the univariate regressions that produced the summary statistics, also consider removing these effects from X before computing R. summary(fitted_rss1)$cs #   cs cs_log10bf cs_avg_r2 cs_min_r2 # 1  2   4.033886 1.0000000 1.0000000 # 2  1   6.744092 0.9634847 0.9634847 # 3  3   3.461476 0.9293299 0.7545197 #                                                                                                      variable # 1                                                                                                         653 # 2                                                                                                     773,777 # 3 362,365,372,373,374,379,381,383,384,386,387,388,389,391,392,396,397,398,399,400,401,403,404,405,407,408,415 susie_plot(fitted_rss1, y=\"PIP\", b=b) fitted = susie(X, Y[,1], L = 10) all.equal(fitted$pip, fitted_rss1$pip) # [1] TRUE all.equal(coef(fitted)[-1], coef(fitted_rss1)[-1]) # [1] TRUE fitted_rss2 = susie_rss(z = z_scores, R = R, n = n, L = 10,                         estimate_residual_variance = TRUE) # HINT: For estimate_residual_variance = TRUE, please check that R is the \"in-sample\" LD matrix; that is, the correlation matrix obtained using the exact same data matrix X that was used for the other summary statistics. Also note, when covariates are included in the univariate regressions that produced the summary statistics, also consider removing these effects from X before computing R. all.equal(fitted$pip, fitted_rss2$pip) # [1] TRUE plot(coef(fitted)[-1], coef(fitted_rss2)[-1], xlab = 'effects from SuSiE', ylab = 'effects from SuSiE-RSS', xlim=c(-1,1), ylim=c(-0.3,0.3)) fitted_standardize = susie(scale(X), scale(Y[,1]), L = 10) all.equal(coef(fitted_standardize)[-1], coef(fitted_rss2)[-1]) # [1] TRUE"},{"path":"https://stephenslab.github.io/susieR/articles/finemapping_summary_statistics.html","id":"fine-mapping-with-susier-using-ld-matrix-from-reference-panel","dir":"Articles","previous_headings":"","what":"Fine-mapping with susieR using LD matrix from reference panel","title":"Fine-mapping with summary statistics","text":"original genotypes available, one may use separate reference panel estimate LD matrix. illustrate , randomly generated 500 samples N(0,R) treated reference panel genotype matrix X_ref. fit SuSiE regression using -sample LD matrix. residual variance fixed 1 estimating residual variance sometimes produces inaccurate estimates --sample LD matrix. output effect estimates standardized X y scale.   particular example, SuSiE result --sample LD similar using -sample LD matrix LD matrices quite similar.   rare cases, sample size n unknown. sample size provided input susie_rss, effect assuming sample size infinity effects small, estimated PVE variant close zero. outputted effect estimates “noncentrality parameter” scale.  ","code":"fitted_rss3 <- susie_rss(z_scores, R_ref, n=n, L = 10) susie_plot(fitted_rss3, y=\"PIP\", b=b) plot(fitted_rss1$pip, fitted_rss3$pip, ylim=c(0,1), xlab='SuSiE PIP', ylab='SuSiE-RSS PIP') fitted_rss4 = susie_rss(z_scores, R_ref, L = 10) # WARNING: Providing the sample size (n), or even a rough estimate of n, is highly recommended. Without n, the implicit assumption is n is large (Inf) and the effect sizes are small (close to zero). susie_plot(fitted_rss4, y=\"PIP\", b=b)"},{"path":"https://stephenslab.github.io/susieR/articles/finemapping_summary_statistics.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"Fine-mapping with summary statistics","text":"details computing environment, including versions R, R packages, used generate results.","code":"sessionInfo() # R version 4.4.3 (2025-02-28) # Platform: x86_64-conda-linux-gnu # Running under: Linux Mint 22 #  # Matrix products: default # BLAS/LAPACK: /home/gw/.pixi/envs/r-base/lib/libopenblasp-r0.3.30.so;  LAPACK version 3.12.0 #  # locale: #  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               #  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     #  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    #  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  #  [9] LC_ADDRESS=C               LC_TELEPHONE=C             # [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        #  # time zone: America/New_York # tzcode source: system (glibc) #  # attached base packages: # [1] stats     graphics  grDevices utils     datasets  methods   base      #  # other attached packages: # [1] susieR_0.14.21 #  # loaded via a namespace (and not attached): #  [1] Matrix_1.7-3       gtable_0.3.6       jsonlite_2.0.0     dplyr_1.1.4        #  [5] compiler_4.4.3     crayon_1.5.3       Rcpp_1.1.0         tidyselect_1.2.1   #  [9] parallel_4.4.3     jquerylib_0.1.4    systemfonts_1.2.3  scales_1.4.0       # [13] textshaping_1.0.1  yaml_2.3.10        fastmap_1.2.0      lattice_0.22-7     # [17] plyr_1.8.9         ggplot2_3.5.2      R6_2.6.1           generics_0.1.4     # [21] mixsqp_0.3-54      knitr_1.50         htmlwidgets_1.6.4  tibble_3.3.0       # [25] desc_1.4.3         RcppZiggurat_0.1.8 bslib_0.9.0        pillar_1.11.0      # [29] RColorBrewer_1.1-3 rlang_1.1.6        reshape_0.8.9      cachem_1.1.0       # [33] xfun_0.52          fs_1.6.6           sass_0.4.10        RcppParallel_5.1.9 # [37] cli_3.6.5          pkgdown_2.1.3      magrittr_2.0.3     digest_0.6.37      # [41] grid_4.4.3         irlba_2.3.5.1      lifecycle_1.0.4    vctrs_0.6.5        # [45] Rfast_2.1.0        evaluate_1.0.4     glue_1.8.0         farver_2.1.2       # [49] ragg_1.4.0         rmarkdown_2.29     matrixStats_1.5.0  tools_4.4.3        # [53] pkgconfig_2.0.3    htmltools_0.5.8.1"},{"path":"https://stephenslab.github.io/susieR/articles/l0_initialization.html","id":"simulate-data","dir":"Articles","previous_headings":"","what":"Simulate data","title":"SuSiE with L0Learn initialization example","text":"First, simulate data minimal example.","code":"set.seed(1) n = 1000 p = 1000 beta = rep(0,p) beta[c(1,2,300,400)] = 1 X = matrix(rnorm(n*p),nrow=n,ncol=p) y = X %*% beta + rnorm(n)"},{"path":"https://stephenslab.github.io/susieR/articles/l0_initialization.html","id":"fit-l0learn","dir":"Articles","previous_headings":"","what":"Fit L0Learn","title":"SuSiE with L0Learn initialization example","text":"start fitting L0-regularized model simulated data. Let’s choose penalty strength parameter minimizes cross-validation error. L0Learn model finds 5 effects, used initialize susie.","code":"set.seed(1) L0fit = L0Learn.cvfit(X, y, penalty = \"L0\") lambdaIndex = which.min(L0fit$cvMeans[[1]])  L0coef = as.numeric(coef(L0fit$fit, lambda = L0fit$fit$lambda[[1]][lambdaIndex])) effect.beta = L0coef[which(L0coef!=0)][-1] effect.index = (which(L0coef!=0)-1)[-1]  length(effect.beta) # [1] 5 effect.beta[1:10] #  [1]  1.0630320  1.0199838  0.9825592  1.0071015 -0.1124103         NA #  [7]         NA         NA         NA         NA effect.index[1:10] #  [1]   1   2 300 400 555  NA  NA  NA  NA  NA"},{"path":"https://stephenslab.github.io/susieR/articles/l0_initialization.html","id":"build-an-initialization-object","dir":"Articles","previous_headings":"","what":"Build an initialization object","title":"SuSiE with L0Learn initialization example","text":"create initialization l0learn coefficients using susie_init_coef function,","code":"set.seed(1) s.init = susie_init_coef(effect.index, effect.beta, p)"},{"path":"https://stephenslab.github.io/susieR/articles/l0_initialization.html","id":"run-susier-with-initialization","dir":"Articles","previous_headings":"","what":"Run susieR with initialization","title":"SuSiE with L0Learn initialization example","text":"Now, use effect.index effect.beta obtained L0Learn fit create s.init object. run susie initialization.","code":"susieL0.fit = susie(X,y,s_init=s.init) susieL0.fit$sets$cs # $L1 # [1] 1 #  # $L2 # [1] 2 #  # $L3 # [1] 300 #  # $L4 # [1] 400"},{"path":"https://stephenslab.github.io/susieR/articles/l0_initialization.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"SuSiE with L0Learn initialization example","text":"Hussein Hazimeh Rahul Mazumder. (2018). Fast Best Subset Selection: Coordinate Descent Local Combinatorial Optimization Algorithms.","code":""},{"path":"https://stephenslab.github.io/susieR/articles/mwe.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"A minimal example","text":"details computing environment, including versions R, R packages, used generate results.","code":"sessionInfo() # R version 4.4.3 (2025-02-28) # Platform: x86_64-conda-linux-gnu # Running under: Linux Mint 22 #  # Matrix products: default # BLAS/LAPACK: /home/gw/.pixi/envs/r-base/lib/libopenblasp-r0.3.30.so;  LAPACK version 3.12.0 #  # locale: #  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               #  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     #  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    #  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  #  [9] LC_ADDRESS=C               LC_TELEPHONE=C             # [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        #  # time zone: America/New_York # tzcode source: system (glibc) #  # attached base packages: # [1] stats     graphics  grDevices utils     datasets  methods   base      #  # other attached packages: # [1] susieR_0.14.21 #  # loaded via a namespace (and not attached): #  [1] Matrix_1.7-3       gtable_0.3.6       jsonlite_2.0.0     dplyr_1.1.4        #  [5] compiler_4.4.3     crayon_1.5.3       Rcpp_1.1.0         tidyselect_1.2.1   #  [9] parallel_4.4.3     jquerylib_0.1.4    systemfonts_1.2.3  scales_1.4.0       # [13] textshaping_1.0.1  yaml_2.3.10        fastmap_1.2.0      lattice_0.22-7     # [17] plyr_1.8.9         ggplot2_3.5.2      R6_2.6.1           generics_0.1.4     # [21] mixsqp_0.3-54      knitr_1.50         htmlwidgets_1.6.4  tibble_3.3.0       # [25] desc_1.4.3         RcppZiggurat_0.1.8 bslib_0.9.0        pillar_1.11.0      # [29] RColorBrewer_1.1-3 rlang_1.1.6        reshape_0.8.9      cachem_1.1.0       # [33] xfun_0.52          fs_1.6.6           sass_0.4.10        RcppParallel_5.1.9 # [37] cli_3.6.5          pkgdown_2.1.3      magrittr_2.0.3     digest_0.6.37      # [41] grid_4.4.3         irlba_2.3.5.1      lifecycle_1.0.4    vctrs_0.6.5        # [45] Rfast_2.1.0        evaluate_1.0.4     glue_1.8.0         farver_2.1.2       # [49] ragg_1.4.0         rmarkdown_2.29     matrixStats_1.5.0  tools_4.4.3        # [53] pkgconfig_2.0.3    htmltools_0.5.8.1"},{"path":"https://stephenslab.github.io/susieR/articles/small_data.html","id":"data","dir":"Articles","previous_headings":"","what":"Data","title":"Small data example","text":"analyze simulated eQTL dataset built normalized gene expression normalized SNP genotypes. goal fine-map causal variants expression (eQTLs). example ground truth unknown.","code":"library(susieR) data(data_small) y <- data_small$y X <- data_small$X dim(X) # [1]   47 7430"},{"path":"https://stephenslab.github.io/susieR/articles/small_data.html","id":"baseline-susie-fit","dir":"Articles","previous_headings":"","what":"Baseline SuSiE fit","title":"Small data example","text":"original SuSiE procedure displays signs misscalibration: result highly suspicious find 10 credible sets data set containing 47 samples.  Another clue fine-mapped variants explain >99% variation gene expression, suggests overfitting.","code":"res_susie <- susie(X,y,L = 10,verbose = FALSE) res_susie$sets$cs # $L2 # [1] 6902 #  # $L3 # [1] 3258 #  # $L5 # [1] 4703 #  # $L7 # [1] 3288 #  # $L9 # [1] 2361 #  # $L1 # [1] 4919 4920 #  # $L6 # [1] 5174 5181 5184 #  # $L8 #  [1] 3978 3979 3980 3981 3984 3985 3987 3988 3989 3990 3991 3992 3993 3994 3996 # [16] 3997 3998 3999 4000 #  # $L4 #  [1] 1658 1660 1661 1665 1667 1668 1670 1672 1673 1674 1675 1678 1679 1680 1681 # [16] 1682 1683 1691 1695 1697 #  # $L10 # [1] 6078 6089 6096 6100 susie_plot(res_susie,y = \"PIP\") ypred <- predict(res_susie, X) pve   <- 1 - drop(res_susie$sigma2 / var(y)) round(100 * pve, 3) # [1] 99.953  plot(y, ypred, pch = 20,      xlab = \"Phenotype\",      ylab = \"Predicted\") abline(0, 1, col = \"magenta\", lty = \"dotted\")"},{"path":"https://stephenslab.github.io/susieR/articles/small_data.html","id":"susie-with-servinstephens-ser-small-true","dir":"Articles","previous_headings":"","what":"SuSiE with Servin–Stephens SER (small = TRUE)","title":"Small data example","text":"Setting small = TRUE switches SuSiE variant single-effect regression (SER) properly accounts uncertainty residual , see following Servin & Stephens (2007, PLOS Genetics). Setting small = TRUE susie call uses slightly different single effect regression (.e. Servin-Stephens single effect regression, see Servin Stephens 2007 PLOS Genetics ) model accounts uncertainty residual. results plausible version SuSiE single CS.  lead SNP CS explains 51% variance expression, plausible","code":"res_susie_small <- susie(X,y,L = 10,small = TRUE,verbose = TRUE) # [1] \"max change in alpha: 0.165158655049151\" # [1] \"max change in alpha: 0.0739855979961968\" # [1] \"max change in alpha: 0.00606943232237271\" # [1] \"max change in alpha: 0.00165047336131911\" # [1] \"max change in alpha: 0.000781249725921514\" # [1] \"max change in alpha: 0.000354188980587232\" # [1] \"max change in alpha: 0.000275048006712034\" # [1] \"max change in alpha: 0.000180419697345139\" # [1] \"max change in alpha: 0.000104593556337134\" # [1] \"max change in alpha: 6.5372392206102e-05\" res_susie_small$sets$cs # $L1 # [1] 4919 4920 susie_plot(res_susie_small,y = \"PIP\") i <- res_susie_small$sets$cs$L1 round(cor(X[,i]),digits = 3) #      [,1] [,2] # [1,]    1    1 # [2,]    1    1 i <- i[1] fit = lm(y ~ X[,i]) pred_small = fit$fitted.values pve <-summary( fit)$r.squared round(100*pve,digits = 3) # [1] 51.462"},{"path":"https://stephenslab.github.io/susieR/articles/small_data.html","id":"compare-predictions-overfit-default-vs-servinstephens-ser","dir":"Articles","previous_headings":"","what":"Compare predictions: overfit (default) vs Servin–Stephens SER","title":"Small data example","text":"References Servin, B. & Stephens, M. (2007). Imputation-based analysis association studies: Candidate regions quantitative traits. PLOS Genetics, 3(7): e114. Denault et al. (2025) Accounting uncertainty residual variances improves calibration fine-mapping small sample sizes, bioRxiv","code":"plot(y, ypred, pch = 20,      xlab = \"Phenotype\",      ylab = \"Predicted\") points(y, pred_small, pch = 20, col = \"blue\") abline(0, 1, col = \"magenta\", lty = \"dotted\") legend(\"topleft\", pch = c(20, 20), col = c(\"black\", \"blue\"),        legend = c(\"SuSiE (default Gaussian SER)\",                   \"SuSiE (Servin–Stephens SER)\") )"},{"path":"https://stephenslab.github.io/susieR/articles/sparse_susie_eval.html","id":"set-up-environment","dir":"Articles","previous_headings":"","what":"Set up environment","title":"Evaluation of sparse version of SuSiE","text":"","code":"library(Matrix) library(susieR) set.seed(1)"},{"path":"https://stephenslab.github.io/susieR/articles/sparse_susie_eval.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Evaluation of sparse version of SuSiE","text":"vignette, provide line profiles revised version SuSiE, allows sparse matrix structure. compare speed performance form matrix X dense sparse. minimal example, observe given large sparse matrix, dense form, speed around 40% slower sparse form.","code":""},{"path":"https://stephenslab.github.io/susieR/articles/sparse_susie_eval.html","id":"simulate-data","dir":"Articles","previous_headings":"","what":"Simulate data","title":"Evaluation of sparse version of SuSiE","text":"randomly simulate n=1000 p=1000 dense matrix sparse matrix sparsity 99\\%, .e. 99\\% entries zeros.","code":"create_sparsity_mat = function(sparsity, n, p) {   nonzero          <- round(n*p*(1-sparsity))   nonzero.idx      <- sample(n*p, nonzero)   mat              <- numeric(n*p)   mat[nonzero.idx] <- 1   mat              <- matrix(mat, nrow=n, ncol=p)   return(mat) } n <- 1000 p <- 1000 beta <- rep(0,p) beta[c(1,300,400,1000)] <- 10  X.dense  <- create_sparsity_mat(0.99,n,p) X.sparse <- as(X.dense,\"CsparseMatrix\") y <- c(X.dense %*% beta + rnorm(n))"},{"path":"https://stephenslab.github.io/susieR/articles/sparse_susie_eval.html","id":"x-in-a-dense-form","dir":"Articles","previous_headings":"","what":"X in a dense form","title":"Evaluation of sparse version of SuSiE","text":"","code":"susie.dense <- susie(X.dense,y)"},{"path":"https://stephenslab.github.io/susieR/articles/sparse_susie_eval.html","id":"x-in-a-sparse-form","dir":"Articles","previous_headings":"","what":"X in a sparse form","title":"Evaluation of sparse version of SuSiE","text":"","code":"susie.sparse <- susie(X.sparse,y)"},{"path":"https://stephenslab.github.io/susieR/articles/sparse_susie_eval.html","id":"further-step","dir":"Articles","previous_headings":"","what":"Further step","title":"Evaluation of sparse version of SuSiE","text":"encourage people insterested improving SuSiE can get insights line profiles provided.","code":""},{"path":"https://stephenslab.github.io/susieR/articles/susie_refine.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"Refine SuSiE model","text":"details computing environment, including versions R, R packages, used generate results.","code":"sessionInfo() # R version 4.4.3 (2025-02-28) # Platform: x86_64-conda-linux-gnu # Running under: Linux Mint 22 #  # Matrix products: default # BLAS/LAPACK: /home/gw/.pixi/envs/r-base/lib/libopenblasp-r0.3.30.so;  LAPACK version 3.12.0 #  # locale: #  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               #  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     #  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    #  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  #  [9] LC_ADDRESS=C               LC_TELEPHONE=C             # [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        #  # time zone: America/New_York # tzcode source: system (glibc) #  # attached base packages: # [1] stats     graphics  grDevices utils     datasets  methods   base      #  # other attached packages: # [1] curl_6.2.2     susieR_0.14.21 #  # loaded via a namespace (and not attached): #  [1] Matrix_1.7-3       gtable_0.3.6       jsonlite_2.0.0     dplyr_1.1.4        #  [5] compiler_4.4.3     crayon_1.5.3       Rcpp_1.1.0         tidyselect_1.2.1   #  [9] parallel_4.4.3     jquerylib_0.1.4    systemfonts_1.2.3  scales_1.4.0       # [13] textshaping_1.0.1  yaml_2.3.10        fastmap_1.2.0      lattice_0.22-7     # [17] plyr_1.8.9         ggplot2_3.5.2      R6_2.6.1           generics_0.1.4     # [21] mixsqp_0.3-54      knitr_1.50         htmlwidgets_1.6.4  tibble_3.3.0       # [25] desc_1.4.3         RcppZiggurat_0.1.8 bslib_0.9.0        pillar_1.11.0      # [29] RColorBrewer_1.1-3 rlang_1.1.6        reshape_0.8.9      cachem_1.1.0       # [33] xfun_0.52          fs_1.6.6           sass_0.4.10        RcppParallel_5.1.9 # [37] cli_3.6.5          pkgdown_2.1.3      magrittr_2.0.3     digest_0.6.37      # [41] grid_4.4.3         irlba_2.3.5.1      lifecycle_1.0.4    vctrs_0.6.5        # [45] Rfast_2.1.0        evaluate_1.0.4     glue_1.8.0         farver_2.1.2       # [49] ragg_1.4.0         rmarkdown_2.29     matrixStats_1.5.0  tools_4.4.3        # [53] pkgconfig_2.0.3    htmltools_0.5.8.1"},{"path":"https://stephenslab.github.io/susieR/articles/susierss_diagnostic.html","id":"ld-information-from-the-original-genotype-data","dir":"Articles","previous_headings":"","what":"LD information from the original genotype data","title":"Diagnostic for fine-mapping with summary statistics","text":"demonstrate diagnostic plot simple case, LD matrix estimated original genotype data. case, expect diagnostic plot confirm LD matrix consistent z scores. use simulated data fine mapping vignette.   estimated \\lambda plot observed z scores vs expected z scores   Summary SuSiE Credible Sets:  ","code":"data(\"N3finemapping\") n = nrow(N3finemapping$X) b = N3finemapping$true_coef[,1] sumstats <- univariate_regression(N3finemapping$X, N3finemapping$Y[,1]) z_scores <- sumstats$betahat / sumstats$sebetahat Rin = cor(N3finemapping$X) attr(Rin, \"eigen\") = eigen(Rin, symmetric = TRUE) susie_plot(z_scores, y = \"z\", b=b) lambda = estimate_s_rss(z_scores, Rin, n=n) lambda # [1] 6.474096e-09 condz_in = kriging_rss(z_scores, Rin, n=n) condz_in$plot fit <- susie_rss(z_scores, Rin, n=n, estimate_residual_variance = TRUE) # HINT: For estimate_residual_variance = TRUE, please check that R is the \"in-sample\" LD matrix; that is, the correlation matrix obtained using the exact same data matrix X that was used for the other summary statistics. Also note, when covariates are included in the univariate regressions that produced the summary statistics, also consider removing these effects from X before computing R. susie_plot(fit,y = \"PIP\", b=b)"},{"path":"https://stephenslab.github.io/susieR/articles/susierss_diagnostic.html","id":"ld-information-from-the-reference-panel","dir":"Articles","previous_headings":"","what":"LD information from the reference panel","title":"Diagnostic for fine-mapping with summary statistics","text":"use another simulated data LD matrix estimated reference panel. example data set, one association signal simulated data (red point), one SNP mismatched reference alternative allele summary statistics reference panel (yellow point). Note: versions PLINK, mismatches can occur PLINK automatically flips alleles make minor allele effect allele, leading different allele encodings z scores LD matrix. Adding flag --keep-allele-order disable behaviour PLINK.   Using data misaligned allele, SuSiE-RSS identifies true positive CS containing true effect SNP; false positive CS incorrectly contains mismatched SNP.   estimated \\lambda diagnostic plot, mismatched SNP shows largest difference observed expected z-scores, therefore appears furthest away diagonal.   fixing allele encoding, SuSiE-RSS identifies single true positive CS containing true-effect SNP, formerly mismatched SNP (correctly) included CS.  ","code":"data_file <- tempfile(fileext = \".RData\") data_url <- paste0(\"https://raw.githubusercontent.com/stephenslab/susieR/\",                    \"master/inst/datafiles/SummaryConsistency1k.RData\") curl_download(data_url,data_file) load(data_file) zflip = SummaryConsistency$z ld = SummaryConsistency$ldref n=10000 b = numeric(length(zflip)) b[SummaryConsistency$signal_id] = zflip[SummaryConsistency$signal_id] plot(zflip, pch = 16, col = \"#767676\", main = \"Marginal Associations\",       xlab=\"SNP\", ylab = \"z scores\") points(SummaryConsistency$signal_id, zflip[SummaryConsistency$signal_id], col=2, pch=16) points(SummaryConsistency$flip_id, zflip[SummaryConsistency$flip_id], col=7, pch=16) fit = susie_rss(zflip, ld, n=n) susie_plot(fit, y='PIP', b=b) points(SummaryConsistency$flip_id, fit$pip[SummaryConsistency$flip_id], col=7, pch=16) lambda = estimate_s_rss(zflip, ld, n=n) lambda # [1] 0.005005011 condz = kriging_rss(zflip, ld, n=n) condz$plot z = zflip z[SummaryConsistency$flip_id] = -z[SummaryConsistency$flip_id] fit = susie_rss(z, ld, n=n) susie_plot(fit, y='PIP', b=b)"},{"path":"https://stephenslab.github.io/susieR/articles/susierss_diagnostic.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"Diagnostic for fine-mapping with summary statistics","text":"details computing environment, including versions R, R packages, used generate results.","code":"sessionInfo() # R version 4.4.3 (2025-02-28) # Platform: x86_64-conda-linux-gnu # Running under: Linux Mint 22 #  # Matrix products: default # BLAS/LAPACK: /home/gw/.pixi/envs/r-base/lib/libopenblasp-r0.3.30.so;  LAPACK version 3.12.0 #  # locale: #  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               #  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     #  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    #  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  #  [9] LC_ADDRESS=C               LC_TELEPHONE=C             # [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        #  # time zone: America/New_York # tzcode source: system (glibc) #  # attached base packages: # [1] stats     graphics  grDevices utils     datasets  methods   base      #  # other attached packages: # [1] curl_6.2.2     susieR_0.14.21 #  # loaded via a namespace (and not attached): #  [1] Matrix_1.7-3       gtable_0.3.6       jsonlite_2.0.0     dplyr_1.1.4        #  [5] compiler_4.4.3     crayon_1.5.3       Rcpp_1.1.0         tidyselect_1.2.1   #  [9] parallel_4.4.3     jquerylib_0.1.4    systemfonts_1.2.3  scales_1.4.0       # [13] textshaping_1.0.1  yaml_2.3.10        fastmap_1.2.0      lattice_0.22-7     # [17] plyr_1.8.9         ggplot2_3.5.2      R6_2.6.1           labeling_0.4.3     # [21] generics_0.1.4     mixsqp_0.3-54      knitr_1.50         htmlwidgets_1.6.4  # [25] tibble_3.3.0       desc_1.4.3         RcppZiggurat_0.1.8 bslib_0.9.0        # [29] pillar_1.11.0      RColorBrewer_1.1-3 rlang_1.1.6        reshape_0.8.9      # [33] cachem_1.1.0       xfun_0.52          fs_1.6.6           sass_0.4.10        # [37] RcppParallel_5.1.9 cli_3.6.5          withr_3.0.2        pkgdown_2.1.3      # [41] magrittr_2.0.3     digest_0.6.37      grid_4.4.3         irlba_2.3.5.1      # [45] lifecycle_1.0.4    vctrs_0.6.5        Rfast_2.1.0        evaluate_1.0.4     # [49] glue_1.8.0         farver_2.1.2       ragg_1.4.0         rmarkdown_2.29     # [53] matrixStats_1.5.0  tools_4.4.3        pkgconfig_2.0.3    htmltools_0.5.8.1"},{"path":"https://stephenslab.github.io/susieR/articles/trend_filtering.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Trend filtering","text":"Although developed SuSiE primarily goal performing variable selection highly sparse settings – , particular, genetic fine-mapping – approach also considerable potential application large-scale regression problems. briefly illustrate potential applying non-parametric regression problem first sight seems ill-suited approach. particular, involve strict sparsity, underlying correlation structure explanatory variables different “blocky” covariance structure genetic data SuSiE designed . Nonetheless, see SuSiE performs well despite (partly due ability capture non-sparse signals via Bayesian Model Averaging). Specifically, consider non-parametric regression: y_t = \\mu_t + e_t \\quad t=1,\\dots,T goal estimate underlying mean, \\mu_t, assumption varies smoothly (, precisely, spatially-structured way) t. One simple way capture spatial structure \\mu model (sparse) linear combination step functions: \\mu = Xb jth column X step function step j (j = 1,\\dots,(T-1)); x_{tj}=0 t<=j 1 t>j. jth element b therefore determines change mean |\\mu_j-\\mu_{j+1}|, assumption b sparse encapsulates assumption \\mu spatially structured (indeed, piecewise constant). simple approach essentially 0th-order trend filtering (Tibshirani, 2014, Annals Statistics 42, 285–323). Note higher-order trend filtering can similarly implemented using different basis functions; use 0th order simplicity.","code":""},{"path":"https://stephenslab.github.io/susieR/articles/trend_filtering.html","id":"examples","dir":"Articles","previous_headings":"","what":"Examples","title":"Trend filtering","text":"apply SuSiE perform 0th order trend filtering simple simulated examples. implemented susieR 0.6.0 funciton susie_trendfilter internally creates X matrix step functions columns match input y. algebra optimized work trendfiltering matrices. simulate data \\mu step function four steps, 0th order trendfiltering problem. regression truly sparse SuSiE well. Plot results: truth black, susie estimate red.   next example mu increases linearly. Thus approximating linear function step functions. truth trully “sparse”, might expect performance poor, bad.   Compare genlasso (lasso-based) solution (blue). (require installation genlasso package, available CRAN, can installed GitHub.) happens linear trend plus sudden change. two fits seem similar accuracy. can check numerically:","code":"library(susieR) set.seed(1) n=1000 mu = c(rep(0,100),rep(1,100),rep(3,100),rep(-2,100),rep(0,600)) y = mu + rnorm(n) s = susie_trendfilter(y, 0, L=10) plot(y,pch=\".\") lines(mu,col=1,lwd=3) lines(predict(s),col=2,lwd=2) s$sigma2 # [1] 1.076207 set.seed(1) mu = seq(0,4,length=1000) y = mu + rnorm(n) s = susie_trendfilter(y,0,L=10) plot(y,pch=\".\") lines(mu,col=1,lwd=3) lines(predict(s),col=2,lwd=2) # install.packages(\"remotes\") # remotes::install_github(\"glmgen/genlasso\") y.tf = trendfilter(y,ord=0) y.tf.cv = cv.trendfilter(y.tf) plot(y,pch=\".\") lines(mu,col=1,lwd=3) lines(predict(s),col=2,lwd=2) lines(y.tf$fit[,which(y.tf$lambda==y.tf.cv$lambda.min)],col=4,lwd=2) set.seed(1) mu = seq(0,4,length=1000) mu = mu + c(rep(0,500),rep(4,500)) y = mu + rnorm(n) s = susie_trendfilter(y,0,L=10) y.tf = trendfilter(y,ord=0) y.tf.cv = cv.trendfilter(y.tf) plot(y,pch=\".\") lines(mu,col=1,lwd=3) lines(predict(s),col=2,lwd=2) lines(y.tf$fit[,which(y.tf$lambda==y.tf.cv$lambda.min)],col=4,lwd=2) sqrt(mean((mu-y.tf$fit[,which(y.tf$lambda==y.tf.cv$lambda.min)])^2)) sqrt(mean((mu-predict(s))^2))"},{"path":"https://stephenslab.github.io/susieR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Gao Wang. Author. Yuxin Zou. Author. Kaiqian Zhang. Author. William R.P. Denault. Author. Peter Carbonetto. Author, maintainer. Matthew Stephens. Author.","code":""},{"path":"https://stephenslab.github.io/susieR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Gao Wang, Abhishek Sarkar, Peter Carbonetto Matthew Stephens (2020). simple new approach variable selection regression, application genetic fine mapping. Journal Royal Statistical Society, Series B, 82, 1273-1300, doi:10.1101/501114 Yuxin Zou, Peter Carbonetto, Gao Wang Matthew Stephens (2022). Fine-mapping summary data \"Sum Single Effects\" model. PLoS Genetics 18, e1010299 doi:10.1371/journal.pgen.1010299","code":"@Article{,   title = {A simple new approach to variable selection in regression, with application to genetic fine mapping},   author = {Gao Wang and Abhishek Sarkar and Peter Carbonetto and Matthew Stephens},   journal = {Journal of the Royal Statistical Society, Series B},   year = {2020},   volume = {82},   pages = {1273-1300},   doi = {10.1101/501114}, } @Article{,   title = {Fine-mapping from summary data with the \"Sum of Single Effects\" model},   author = {Yuxin Zou and Peter Carbonetto and Gao Wang and Matthew Stephens},   journal = {PLoS Genetics},   volume = {18},   year = {2022},   pages = {e1010299},   doi = {10.1371/journal.pgen.1010299}, }"},{"path":"https://stephenslab.github.io/susieR/index.html","id":"susier","dir":"","previous_headings":"","what":"Sum of Single Effects Linear Regression","title":"Sum of Single Effects Linear Regression","text":"susieR package implements simple new way perform variable selection multiple regression (y=Xb+e). methods implemented particularly well-suited settings X variables highly correlated, true effects highly sparse (e.g. <20 non-zero effects vector b). One example genetic fine-mapping applications, application major motivation developing methods. However, methods also useful generally. methods based new model sparse multiple regression, call “Sum Single Effects” (SuSiE) model. model, described manuscript preparation (Wang et al), lends particularly simple intuitive fitting procedure – effectively Bayesian modification simple forward selection, call “Iterative Bayesian Step-wise Selection”. output fitting procedure number “Credible Sets” (CSs), designed high probability contain variable non-zero effect, time small possible. can think CSs set “highly correlated” variables associated response: can confident one variables non-zero coefficient, correlated sure one. package developed Gao Wang, Peter Carbonetto, Yuxin Zou, Kaiqian Zhang, Matthew Stephens Stephens Lab University Chicago. Please post issues ask questions, get support provide us feedback; please send pull requests helped fixing bugs making improvements source code.","code":""},{"path":"https://stephenslab.github.io/susieR/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick Start","title":"Sum of Single Effects Linear Regression","text":"Install susieR CRAN: Alternatively, install latest development version susieR GitHub: See brief illustration susieR. documentation examples please visit https://stephenslab.github.io/susieR","code":"install.packages(\"susieR\") # install.packages(\"remotes\") remotes::install_github(\"stephenslab/susieR\")"},{"path":"https://stephenslab.github.io/susieR/index.html","id":"citing-this-work","dir":"","previous_headings":"","what":"Citing this work","title":"Sum of Single Effects Linear Regression","text":"find susieR package source code repository useful work, please cite: G. Wang, G., Sarkar, ., Carbonetto, P. & Stephens, M. (2020). simple new approach variable selection regression, application genetic fine mapping. Journal Royal Statistical Society, Series B 82, 1273–1300. https://doi.org/10.1111/rssb.12388 use summary data methods susie_suff_stat susie_rss, please also cite: Zou, Y., Carbonetto, P., Wang, G. & Stephens, M. (2022). Fine-mapping summary data “Sum Single Effects” model. PLoS Genetics 18, e1010299. https://doi.org/10.1371/journal.pgen.1010299","code":""},{"path":"https://stephenslab.github.io/susieR/index.html","id":"developer-notes","dir":"","previous_headings":"","what":"Developer notes","title":"Sum of Single Effects Linear Regression","text":"Makefile contains various R commands build maintain package. example build website via pkgdown: changes made roxygen2 markup, run make document update package NAMESPACE documentation files. format R codes R folder,","code":"make pkgdown for i in `ls R/*.R`; do bash inst/misc/format_r_code.sh $i; done"},{"path":"https://stephenslab.github.io/susieR/reference/FinemappingConvergence.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated Fine-mapping Data with Convergence Problem. — FinemappingConvergence","title":"Simulated Fine-mapping Data with Convergence Problem. — FinemappingConvergence","text":"Data simulated using real genotypes 50,000   individuals 200 SNPs. Two SNPs non-zero effects   multivariate response. response data generated   linear regression model. simulated response columns   genotype matrix centered.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/FinemappingConvergence.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated Fine-mapping Data with Convergence Problem. — FinemappingConvergence","text":"FinemappingConvergence list following elements: XtX Summary statistics computed using centered     scaled genotype matrix. Xty Summary statistics computed using centered     scaled genotype data, centered simulated response. yty yty computed using centered simulated response. n sample size (50,000). true_coef coefficients used simulate responses. z z-scores simple (single-SNP) linear regression.","code":""},{"path":[]},{"path":"https://stephenslab.github.io/susieR/reference/FinemappingConvergence.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulated Fine-mapping Data with Convergence Problem. — FinemappingConvergence","text":"","code":"data(FinemappingConvergence)"},{"path":"https://stephenslab.github.io/susieR/reference/N2finemapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated Fine-mapping Data with Two Effect Variables — N2finemapping","title":"Simulated Fine-mapping Data with Two Effect Variables — N2finemapping","text":"data set contains genotype matrix 574   individuals 1,002 variables. variables genotypes   centering scaling, therefore retain correlation   structure original genotype data. Two variables   non-zero effects multivariate response. response data   generated multivariate linear regression model. See   Wang et al (2020) details.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/N2finemapping.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated Fine-mapping Data with Two Effect Variables — N2finemapping","text":"N2finemapping list following elements: X Centered scaled genotype data. chrom Chromomsome original data, hg38 coordinates. pos Chromomosomal position original data, hg38     coordinates. information can used compare impact using     genotype references variables susie_rss     application. true_coef Simulated effect sizes. residual_variance Simulated residual covariance matrix. Y Simulated multivariate response. allele_freq Allele frequencies based original     genotype data. V Suggested prior covariance matrix effect sizes      two non-zero effect variables.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/N2finemapping.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulated Fine-mapping Data with Two Effect Variables — N2finemapping","text":"G. Wang, . Sarkar, P. Carbonetto M. Stephens (2020). simple   new approach variable selection regression, application   genetic fine-mapping. Journal Royal Statistical   Society, Series B doi:10.1101/501114 .","code":""},{"path":"https://stephenslab.github.io/susieR/reference/N2finemapping.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulated Fine-mapping Data with Two Effect Variables — N2finemapping","text":"","code":"data(N2finemapping)"},{"path":"https://stephenslab.github.io/susieR/reference/N3finemapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated Fine-mapping Data with Three Effect Variables. — N3finemapping","title":"Simulated Fine-mapping Data with Three Effect Variables. — N3finemapping","text":"data-set contains matrix 574 individuals 1,001 variables. variables real-world genotypes centered scaled, therefore retains correlation structure variables original genotype data. 3 variables non-zero effects.  response data generated multivariate linear regression model. See Wang et al (2020) details.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/N3finemapping.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated Fine-mapping Data with Three Effect Variables. — N3finemapping","text":"N3finemapping list following elements: X N P variable matrix centered scaled genotype data. chrom Chromomsome original data, hg38 coordinate. pos Chromomosomal positoin original data, hg38 coordinate. information can used compare impact using genotype references variables susie_rss application. true_coef simulated effect sizes. residual_variance simulated residual covariance matrix. Y simulated response variables. allele_freq Allele frequency original genotype data. V Prior covariance matrix effect size three non-zero effect variables.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/N3finemapping.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulated Fine-mapping Data with Three Effect Variables. — N3finemapping","text":"G. Wang, . Sarkar, P. Carbonetto M. Stephens (2020). simple   new approach variable selection regression, application   genetic fine-mapping. Journal Royal Statistical   Society, Series B doi:10.1101/501114 .","code":""},{"path":"https://stephenslab.github.io/susieR/reference/N3finemapping.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulated Fine-mapping Data with Three Effect Variables. — N3finemapping","text":"","code":"data(N3finemapping)"},{"path":"https://stephenslab.github.io/susieR/reference/SummaryConsistency.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated Fine-mapping Data with LD matrix From Reference Panel. — SummaryConsistency","title":"Simulated Fine-mapping Data with LD matrix From Reference Panel. — SummaryConsistency","text":"Data simulated using real genotypes 10,000   individuals 200 SNPs. One SNP non-zero effect   multivariate response. response data generated   linear regression model. also one SNP flipped allele   summary statistics reference panel.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/SummaryConsistency.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated Fine-mapping Data with LD matrix From Reference Panel. — SummaryConsistency","text":"SummaryConsistency list following elements: z z-scores computed fitting univariate simple regression     variable--variable. ldref LD matrix estimated reference panel. flip_id index SNP flipped allele. signal_id index SNP non-zero effect.","code":""},{"path":[]},{"path":"https://stephenslab.github.io/susieR/reference/SummaryConsistency.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulated Fine-mapping Data with LD matrix From Reference Panel. — SummaryConsistency","text":"","code":"data(SummaryConsistency)"},{"path":"https://stephenslab.github.io/susieR/reference/coef.susie.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract regression coefficients from susie fit — coef.susie","title":"Extract regression coefficients from susie fit — coef.susie","text":"Extract regression coefficients susie fit","code":""},{"path":"https://stephenslab.github.io/susieR/reference/coef.susie.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract regression coefficients from susie fit — coef.susie","text":"","code":"# S3 method for class 'susie' coef(object, ...)"},{"path":"https://stephenslab.github.io/susieR/reference/coef.susie.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract regression coefficients from susie fit — coef.susie","text":"object susie fit. ... Additional arguments passed generic coef method.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/coef.susie.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract regression coefficients from susie fit — coef.susie","text":"p+1 vector, first element intercept,   remaining p elements estimated regression coefficients.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/compute_ss.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute sufficient statistics for input to susie_suff_stat — compute_ss","title":"Compute sufficient statistics for input to susie_suff_stat — compute_ss","text":"synonym compute_suff_stat   included historical reasons (deprecated).","code":""},{"path":"https://stephenslab.github.io/susieR/reference/compute_ss.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute sufficient statistics for input to susie_suff_stat — compute_ss","text":"","code":"compute_ss(X, y, standardize = FALSE)"},{"path":"https://stephenslab.github.io/susieR/reference/compute_ss.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute sufficient statistics for input to susie_suff_stat — compute_ss","text":"X n p matrix covariates. y n vector. standardize Logical flag indicating whether standardize columns X unit variance prior computing summary data.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/compute_ss.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute sufficient statistics for input to susie_suff_stat — compute_ss","text":"list sufficient statistics (X'X, X'y, y'y n)","code":""},{"path":"https://stephenslab.github.io/susieR/reference/compute_ss.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute sufficient statistics for input to susie_suff_stat — compute_ss","text":"","code":"data(N2finemapping) ss = compute_ss(N2finemapping$X, N2finemapping$Y[,1])"},{"path":"https://stephenslab.github.io/susieR/reference/compute_suff_stat.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute sufficient statistics for input to susie_suff_stat — compute_suff_stat","title":"Compute sufficient statistics for input to susie_suff_stat — compute_suff_stat","text":"Computes sufficient statistics \\(X'X, X'y, y'y\\)   \\(n\\) centering (possibly standardizing)   columns \\(X\\) centering \\(y\\) mean zero. also   store column means \\(X\\) mean \\(y\\).","code":""},{"path":"https://stephenslab.github.io/susieR/reference/compute_suff_stat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute sufficient statistics for input to susie_suff_stat — compute_suff_stat","text":"","code":"compute_suff_stat(X, y, standardize = FALSE)"},{"path":"https://stephenslab.github.io/susieR/reference/compute_suff_stat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute sufficient statistics for input to susie_suff_stat — compute_suff_stat","text":"X n p matrix covariates. y n vector. standardize Logical flag indicating whether standardize columns X unit variance prior computing summary data","code":""},{"path":"https://stephenslab.github.io/susieR/reference/compute_suff_stat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute sufficient statistics for input to susie_suff_stat — compute_suff_stat","text":"list sufficient statistics (XtX, Xty, yty, n)   X_colmeans, y_mean.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/compute_suff_stat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute sufficient statistics for input to susie_suff_stat — compute_suff_stat","text":"","code":"data(N2finemapping) ss = compute_suff_stat(N2finemapping$X, N2finemapping$Y[,1])"},{"path":"https://stephenslab.github.io/susieR/reference/estimate_s_rss.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate s in susie_rss Model Using Regularized LD — estimate_s_rss","title":"Estimate s in susie_rss Model Using Regularized LD — estimate_s_rss","text":"estimated s gives information   consistency z scores LD matrix. larger \\(s\\)   means strong inconsistency z scores LD   matrix. “null-mle” method obtains mle \\(s\\)   \\(z | R ~ N(0,(1-s)R + s )\\), \\(0 < s < 1\\).   “null-partialmle” method obtains mle \\(s\\)   \\(U^T z | R ~ N(0,s )\\), \\(U\\) matrix containing   eigenvectors span null space R; ,   eigenvectors corresponding zero eigenvalues R. estimated   \\(s\\) “null-partialmle” greater 1.   “null-pseudomle” method obtains mle \\(s\\)   pseudolikelihood \\(L(s) = \\prod_{j=1}^{p} p(z_j | z_{-j}, s,   R)\\), \\(0 < s < 1\\).","code":""},{"path":"https://stephenslab.github.io/susieR/reference/estimate_s_rss.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate s in susie_rss Model Using Regularized LD — estimate_s_rss","text":"","code":"estimate_s_rss(z, R, n, r_tol = 1e-08, method = \"null-mle\")"},{"path":"https://stephenslab.github.io/susieR/reference/estimate_s_rss.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate s in susie_rss Model Using Regularized LD — estimate_s_rss","text":"z p-vector z scores. R p p symmetric, positive semidefinite correlation matrix. n sample size. (Optional, highly recommended.) r_tol Tolerance level eigenvalue check positive semidefinite matrix R. method string specifies method estimate \\(s\\).","code":""},{"path":"https://stephenslab.github.io/susieR/reference/estimate_s_rss.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate s in susie_rss Model Using Regularized LD — estimate_s_rss","text":"number 0 1.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/estimate_s_rss.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate s in susie_rss Model Using Regularized LD — estimate_s_rss","text":"","code":"set.seed(1) n = 500 p = 1000 beta = rep(0,p) beta[1:4] = 0.01 X = matrix(rnorm(n*p),nrow = n,ncol = p) X = scale(X,center = TRUE,scale = TRUE) y = drop(X %*% beta + rnorm(n)) input_ss = compute_suff_stat(X,y,standardize = TRUE) ss = univariate_regression(X,y) R = cor(X) attr(R,\"eigen\") = eigen(R,symmetric = TRUE) zhat = with(ss,betahat/sebetahat)  # Estimate s using the unadjusted z-scores. s0 = estimate_s_rss(zhat,R) #> WARNING: Providing the sample size (n), or even a rough estimate of n, is highly recommended. Without n, the implicit assumption is n is large (Inf) and the effect sizes are small (close to zero).  # Estimate s using the adjusted z-scores. s1 = estimate_s_rss(zhat,R,n)"},{"path":"https://stephenslab.github.io/susieR/reference/get_cs_correlation.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Correlations Between CSs, using Variable with Maximum PIP From Each CS — get_cs_correlation","title":"Get Correlations Between CSs, using Variable with Maximum PIP From Each CS — get_cs_correlation","text":"function evaluates correlation single effect   CSs. part SuSiE inference. Rather, designed   diagnostic tool assess correlated reported CS .","code":""},{"path":"https://stephenslab.github.io/susieR/reference/get_cs_correlation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Correlations Between CSs, using Variable with Maximum PIP From Each CS — get_cs_correlation","text":"","code":"get_cs_correlation(model, X = NULL, Xcorr = NULL, max = FALSE)"},{"path":"https://stephenslab.github.io/susieR/reference/get_cs_correlation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Correlations Between CSs, using Variable with Maximum PIP From Each CS — get_cs_correlation","text":"model SuSiE fit, typically output susie one variants. X n p matrix values p variables (covariates) n samples. provided, correlation variables computed used remove CSs whose minimum correlation among variables smaller min_abs_corr. Xcorr p p matrix correlations variables (covariates). provided, used remove CSs whose minimum correlation among variables smaller min_abs_corr. max max = FAFLSE, return matrix CS correlations. max = TRUE, return maximum absolute correlation among pairs correlations.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/get_cs_correlation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Correlations Between CSs, using Variable with Maximum PIP From Each CS — get_cs_correlation","text":"matrix correlations CSs, maximum   absolute correlation max = TRUE.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/kriging_rss.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Distribution of z-scores of Variant j Given Other z-scores, and Detect Possible Allele Switch Issue — kriging_rss","title":"Compute Distribution of z-scores of Variant j Given Other z-scores, and Detect Possible Allele Switch Issue — kriging_rss","text":"null, rss model regularized LD   matrix \\(z|R,s ~ N(0, (1-s)R + s ))\\). use mixture   normals model conditional distribution z_j given z   scores, \\(z_j | z_{-j}, R, s ~ \\sum_{k=1}^{K} \\pi_k   N(-\\Omega_{j,-j} z_{-j}/\\Omega_{jj}, \\sigma_{k}^2/\\Omega_{jj})\\),   \\(\\Omega = ((1-s)R + sI)^{-1}\\), \\(\\sigma_1, ..., \\sigma_k\\)   grid fixed positive numbers. estimate mixture   weights \\(\\pi\\)  detect possible allele switch issue   using likelihood ratio variant.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/kriging_rss.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Distribution of z-scores of Variant j Given Other z-scores, and Detect Possible Allele Switch Issue — kriging_rss","text":"","code":"kriging_rss(   z,   R,   n,   r_tol = 1e-08,   s = estimate_s_rss(z, R, n, r_tol, method = \"null-mle\") )"},{"path":"https://stephenslab.github.io/susieR/reference/kriging_rss.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Distribution of z-scores of Variant j Given Other z-scores, and Detect Possible Allele Switch Issue — kriging_rss","text":"z p-vector z scores. R p p symmetric, positive semidefinite correlation matrix. n sample size. (Optional, highly recommended.) r_tol Tolerance level eigenvalue check positive semidefinite matrix R. s estimated s estimate_s_rss","code":""},{"path":"https://stephenslab.github.io/susieR/reference/kriging_rss.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Distribution of z-scores of Variant j Given Other z-scores, and Detect Possible Allele Switch Issue — kriging_rss","text":"list containing ggplot2 plot object table. plot   compares observed z score vs expected value. possible allele   switched variants labeled red points (log LR > 2 abs(z) > 2).   table summarizes conditional distribution variant   likelihood ratio test. table following columns:   observed z scores, conditional expectation, conditional   variance, standardized differences observed z score   expected value, log likelihood ratio statistics.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/kriging_rss.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Distribution of z-scores of Variant j Given Other z-scores, and Detect Possible Allele Switch Issue — kriging_rss","text":"","code":"# See also the vignette, \"Diagnostic for fine-mapping with summary # statistics.\" set.seed(1) n = 500 p = 1000 beta = rep(0,p) beta[1:4] = 0.01 X = matrix(rnorm(n*p),nrow = n,ncol = p) X = scale(X,center = TRUE,scale = TRUE) y = drop(X %*% beta + rnorm(n)) ss = univariate_regression(X,y) R = cor(X) attr(R,\"eigen\") = eigen(R,symmetric = TRUE) zhat = with(ss,betahat/sebetahat) cond_dist = kriging_rss(zhat,R,n = n) cond_dist$plot"},{"path":"https://stephenslab.github.io/susieR/reference/predict.susie.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict outcomes or extract coefficients from susie fit. — predict.susie","title":"Predict outcomes or extract coefficients from susie fit. — predict.susie","text":"Predict outcomes extract coefficients susie fit.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/predict.susie.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict outcomes or extract coefficients from susie fit. — predict.susie","text":"","code":"# S3 method for class 'susie' predict(object, newx = NULL, type = c(\"response\", \"coefficients\"), ...)"},{"path":"https://stephenslab.github.io/susieR/reference/predict.susie.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict outcomes or extract coefficients from susie fit. — predict.susie","text":"object susie fit. newx new value X predictions. type type output. type = \"response\", predicted fitted outcomes returned; type = \"coefficients\", estimated coefficients returned. ... arguments used generic predict function. extra arguments used .","code":""},{"path":"https://stephenslab.github.io/susieR/reference/predict.susie.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict outcomes or extract coefficients from susie fit. — predict.susie","text":"type = \"response\", predicted fitted outcomes   returned; type = \"coefficients\", estimated   coefficients returned. susie fit intercept =   NA (common using susie_suff_stat)   predictions computed using intercept 0, warning   emitted.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/single_effect_regression.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian single-effect linear regression — single_effect_regression","title":"Bayesian single-effect linear regression — single_effect_regression","text":"methods fit regression model \\(y = Xb +   e\\), elements e ..d.  \\(N(0,s^2)\\), b   p-vector effects estimated. assumption b   exactly one non-zero element, elements equally likely   non-zero. prior coefficient non-zero element   \\(N(0,V)\\).","code":""},{"path":"https://stephenslab.github.io/susieR/reference/single_effect_regression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian single-effect linear regression — single_effect_regression","text":"","code":"single_effect_regression(   y,   X,   V,   residual_variance = 1,   prior_weights = NULL,   optimize_V = c(\"none\", \"optim\", \"uniroot\", \"EM\", \"simple\"),   check_null_threshold = 0,   small = FALSE,   alpha0 = 0,   beta0 = 0 )  single_effect_regression_rss(   z,   Sigma,   V = 1,   prior_weights = NULL,   optimize_V = c(\"none\", \"optim\", \"uniroot\", \"EM\", \"simple\"),   check_null_threshold = 0 )  single_effect_regression_ss(   Xty,   dXtX,   V = 1,   residual_variance = 1,   prior_weights = NULL,   optimize_V = c(\"none\", \"optim\", \"uniroot\", \"EM\", \"simple\"),   check_null_threshold = 0 )"},{"path":"https://stephenslab.github.io/susieR/reference/single_effect_regression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian single-effect linear regression — single_effect_regression","text":"y n-vector. X n p matrix covariates. V scalar giving (initial) prior variance residual_variance residual variance. prior_weights p-vector prior weights. optimize_V optimization method use fitting prior variance. check_null_threshold Scalar specifying threshold log-scale compare likelihood current estimate zero null. small Logical. Useful fitting susie data limited sample size. set TRUE, susie fitted using single-effect regression Servin Stephens prior instead default Gaussian prior. improves calibration credible sets. Default FALSE. alpha0 Numerical parameter NIG prior using Servin Stephens SER. beta0 Numerical parameter NIG prior using Servin Stephens SER. z p-vector z scores. Sigma residual_var*R + lambda*Xty p-vector. dXtX p-vector containing diagonal elements crossprod(X).","code":""},{"path":"https://stephenslab.github.io/susieR/reference/single_effect_regression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian single-effect linear regression — single_effect_regression","text":"list following elements: alpha Vector posterior inclusion probabilities;   alpha[] posterior probability ith coefficient   non-zero. mu Vector posterior means (conditional inclusion). mu2 Vector posterior second moments (conditional   inclusion). lbf Vector log-Bayes factors variable. lbf_model Log-Bayes factor single effect regression. single_effect_regression single_effect_regression_ss additionally output: V Prior variance (optimization optimize_V !=   \"none\"). loglik log-likelihood, \\(\\log p(y | X, V)\\).","code":""},{"path":"https://stephenslab.github.io/susieR/reference/single_effect_regression.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bayesian single-effect linear regression — single_effect_regression","text":"single_effect_regression_ss performs single-effect linear regression summary data, statistcs \\(X^Ty\\) diagonal elements \\(X^TX\\) provided method. single_effect_regression_rss performs single-effect linear regression z scores. , function fits regression model \\(z = R*b + e\\), e \\(N(0,Sigma)\\), \\(Sigma = residual_var*R + lambda*\\), b p-vector effects estimated. assumption b exactly one non-zero element, elements equally likely non-zero. prior non-zero element \\(N(0,V)\\). required summary data p-vector z p p matrix Sigma. summary statistics come individuals.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/summary.susie.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize Susie Fit. — summary.susie","title":"Summarize Susie Fit. — summary.susie","text":"summary method “susie” class.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/summary.susie.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize Susie Fit. — summary.susie","text":"","code":"# S3 method for class 'susie' summary(object, ...)  # S3 method for class 'summary.susie' print(x, ...)"},{"path":"https://stephenslab.github.io/susieR/reference/summary.susie.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize Susie Fit. — summary.susie","text":"object susie fit. ... Additional arguments passed generic summary print.summary method. x susie summary.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/summary.susie.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize Susie Fit. — summary.susie","text":"summary.susie returns list containing data frame   variables data frame credible sets.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie.html","id":null,"dir":"Reference","previous_headings":"","what":"Sum of Single Effects (SuSiE) Regression — susie","title":"Sum of Single Effects (SuSiE) Regression — susie","text":"Performs sparse Bayesian multiple linear regression   y X, using \"Sum Single Effects\" model Wang et al   (2020). brief, function fits regression model \\(y =   \\mu + X b + e\\), elements \\(e\\) ..d. normal   zero mean variance residual_variance, \\(\\mu\\)   intercept term \\(b\\) vector length p representing   effects estimated. “susie assumption”   \\(b = \\sum_{l=1}^L b_l\\) \\(b_l\\) vector   length p exactly one non-zero element. prior   non-zero element normal zero mean variance var(y)   * scaled_prior_variance. value L fixed,   chosen provide reasonable upper bound number   non-zero effects detected. Typically, hyperparameters   residual_variance scaled_prior_variance   estimated model fitting, although can also fixed   specified user. See functions susie_get_cs   functions form susie_get_* extract   commonly-used results susie fit.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sum of Single Effects (SuSiE) Regression — susie","text":"","code":"susie(   X,   y,   L = min(10, ncol(X)),   small = FALSE,   scaled_prior_variance = 0.2,   residual_variance = NULL,   prior_weights = NULL,   null_weight = 0,   standardize = TRUE,   intercept = TRUE,   estimate_residual_variance = TRUE,   estimate_prior_variance = TRUE,   estimate_prior_method = c(\"optim\", \"EM\", \"simple\"),   check_null_threshold = 0,   prior_tol = 1e-09,   residual_variance_upperbound = Inf,   s_init = NULL,   coverage = 0.95,   min_abs_corr = 0.5,   compute_univariate_zscore = FALSE,   na.rm = FALSE,   max_iter = 100,   tol = 0.001,   tol_small = 1e-04,   verbose = FALSE,   track_fit = FALSE,   residual_variance_lowerbound = var(drop(y))/10000,   refine = FALSE,   n_purity = 100,   alpha0 = 0,   beta0 = 0 )  susie_suff_stat(   XtX,   Xty,   yty,   n,   X_colmeans = NA,   y_mean = NA,   maf = NULL,   maf_thresh = 0,   L = 10,   scaled_prior_variance = 0.2,   residual_variance = NULL,   estimate_residual_variance = TRUE,   estimate_prior_variance = TRUE,   estimate_prior_method = c(\"optim\", \"EM\", \"simple\"),   check_null_threshold = 0,   prior_tol = 1e-09,   r_tol = 1e-08,   prior_weights = NULL,   null_weight = 0,   standardize = TRUE,   max_iter = 100,   s_init = NULL,   coverage = 0.95,   min_abs_corr = 0.5,   tol = 0.001,   verbose = FALSE,   track_fit = FALSE,   check_input = FALSE,   refine = FALSE,   check_prior = FALSE,   n_purity = 100,   ... )"},{"path":"https://stephenslab.github.io/susieR/reference/susie.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sum of Single Effects (SuSiE) Regression — susie","text":"X n p matrix covariates. y observed responses, vector length n. L Maximum number non-zero effects susie regression model. L larger number covariates, p, L set p. small Logical. Useful fitting susie data limited sample size. set TRUE, susie fitted using single-effect regression Servin Stephens prior instead default Gaussian prior. improves calibration credible sets.  Default FALSE. scaled_prior_variance prior variance, divided var(y) ((1/(n-1))yty susie_suff_stat); , prior variance non-zero element b var(y) * scaled_prior_variance. value provided either scalar vector length L. estimate_prior_variance = TRUE, provides initial estimates prior variances. residual_variance Variance residual. estimate_residual_variance = TRUE, value provides initial estimate residual variance. default, set var(y) susie (1/(n-1))yty susie_suff_stat. prior_weights vector length p, entry gives prior probability corresponding column X nonzero effect outcome, y. null_weight Prior probability effect (number 0 1, exactly 1). standardize standardize = TRUE, standardize columns X unit variance prior fitting (equivalently standardize XtX Xty effect). Note scaled_prior_variance specifies prior coefficients X standardization (performed). standardize, may need think carefully specifying scaled_prior_variance. Whatever choice, coefficients returned coef given X original input scale. column X zero variance standardized. intercept intercept = TRUE, intercept fitted; intercept = FALSE, intercept set zero. Setting intercept = FALSE generally recommended. estimate_residual_variance estimate_residual_variance = TRUE, residual variance estimated, using residual_variance initial value. estimate_residual_variance = FALSE, residual variance fixed value supplied residual_variance. estimate_prior_variance estimate_prior_variance = TRUE, prior variance estimated (separate parameter L effects). provided, scaled_prior_variance used initial value optimization. estimate_prior_variance = FALSE, prior variance L effects determined value supplied scaled_prior_variance. estimate_prior_method method used estimating prior variance. estimate_prior_method = \"simple\" used, likelihood specified prior variance compared likelihood variance zero, setting larger likelihood retained. option \"EM\" selected default   setting small=TRUE, .e., using SuSiE Servin Stephens SER check_null_threshold prior variance estimated, compare estimate null, set prior variance zero unless log-likelihood using estimate larger threshold amount. example, set check_null_threshold = 0.1, \"nudge\" estimate towards zero difference log-likelihoods small. note caution setting value greater zero may lead IBSS fitting procedure occasionally decrease ELBO. prior_tol prior variance estimated, compare estimated value prior_tol end computation, exclude single effect PIP computation estimated prior variance smaller tolerance value. residual_variance_upperbound Upper limit estimated residual variance. relevant estimate_residual_variance = TRUE. s_init previous susie fit initialize. coverage number 0 1 specifying “coverage” estimated confidence sets. min_abs_corr Minimum absolute correlation allowed credible set. default, 0.5, corresponds squared correlation 0.25, commonly used threshold genotype data genetic studies. compute_univariate_zscore compute_univariate_zscore = TRUE, univariate regression z-scores outputted variable. na.rm Drop missing values y X y. max_iter Maximum number IBSS iterations perform. tol small, non-negative number specifying convergence tolerance IBSS fitting procedure. fitting procedure halt difference variational lower bound, “ELBO” (objective function maximized), less tol. tol_small used small = TRUE . Small, non-negative number specifying convergence tolerance GIBSS fitting procedure. fitting procedure halt difference estimated posterior inclusion probability less tol. verbose verbose = TRUE, algorithm's progress, summary optimization settings, printed console. track_fit track_fit = TRUE, trace also returned containing detailed information estimates iteration IBSS fitting procedure. residual_variance_lowerbound Lower limit estimated residual variance. relevant estimate_residual_variance = TRUE. refine refine = TRUE, additional iterative refinement procedure used, IBSS algorithm, check escape local optima (see details). n_purity Passed argument n_purity susie_get_cs. alpha0 Numerical parameter NIG prior using Servin Stephens SER. beta0 Mumerical parameter NIG prior using Servin Stephens SER. XtX p p matrix \\(X'X\\) columns X centered mean zero. Xty p-vector \\(X'y\\) y columns X centered mean zero. yty scalar \\(y'y\\) y centered mean zero. n sample size. X_colmeans p-vector column means X. X_colmeans y_mean provided, intercept estimated; otherwise, intercept NA. y_mean scalar containing mean y. X_colmeans y_mean provided, intercept estimated; otherwise, intercept NA. maf Minor allele frequency; used along maf_thresh filter input summary statistics. maf_thresh Variants minor allele frequency smaller threshold used. r_tol Tolerance level eigenvalue check positive semidefinite matrix R. check_input check_input = TRUE, susie_suff_stat performs additional checks XtX Xty. checks : (1) check XtX positive semidefinite; (2) check Xty space spanned non-zero eigenvectors XtX. check_prior check_prior = TRUE, checks estimated prior variance becomes unreasonably large (comparing 10 * max(abs(z))^2). ... Additional arguments provide backward compatibility earlier versions susie_suff_stat.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sum of Single Effects (SuSiE) Regression — susie","text":"\"susie\" object following   elements: alpha L p matrix posterior inclusion probabilites. mu L p matrix posterior means, conditional   inclusion. mu2 L p matrix posterior second moments,   conditional inclusion. Xr vector length n, equal X %*% colSums(alpha   * mu). lbf log-Bayes Factor single effect. lbf_variable log-Bayes Factor variable single effect. intercept Intercept (fixed estimated). sigma2 Residual variance (fixed estimated). V Prior variance non-zero elements b, equal   scaled_prior_variance * var(y). elbo value variational lower bound,   “ELBO” (objective function maximized), achieved   iteration IBSS fitting procedure. cv_criterion value maximum difference alpha value iteration , returned argument small set TRUE fitted Vector length n containing fitted values   outcome. sets Credible sets estimated model fit; see   susie_get_cs details. pip vector length p giving (marginal) posterior   inclusion probabilities p covariates. z vector univariate z-scores. niter Number IBSS iterations performed. converged TRUE FALSE indicating whether   IBSS converged solution within chosen tolerance   level. susie_suff_stat returns also outputs: XtXr p-vector t(X) times fitted values,   X %*% colSums(alpha*mu).","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sum of Single Effects (SuSiE) Regression — susie","text":"function susie implements IBSS algorithm Wang et al (2020). option refine = TRUE implements additional step help reduce problems caused convergence IBSS algorithm poor local optima (rare experience, can provide misleading results occurs). refinement step incurs additional computational expense increases number CSs found initial run. function susie_suff_stat implements essentially algorithms, using sufficient statistics. (statistics sufficient regression coefficients \\(b\\), intercept \\(\\mu\\); see intercept treated.) sufficient statistics computed correctly results susie_suff_stat (similar ) susie, although runtimes differ discussed . sufficient statistics sample size n, p p matrix \\(X'X\\), p-vector \\(X'y\\), sum squared y values \\(y'y\\), computed centering columns \\(X\\) vector \\(y\\) mean 0; can computed using compute_suff_stat. handling intercept term susie_suff_stat needs additional explanation. Computing summary data centering X y effectively ensures resulting posterior quantities \\(b\\) allow intercept model; however, actual value intercept estimated centered data. estimate intercept term user must also provide column means \\(X\\) mean \\(y\\) (X_colmeans y_mean). provided, treated NA, results intercept NA. reason prefer intercept 0 instead NA set X_colmeans = 0,y_mean = 0. completeness, note susie_suff_stat run \\(X'X, X'y, y'y\\) computed without centering \\(X\\) \\(y\\), X_colmeans = 0,y_mean = 0, equivalent susie applied \\(X, y\\) intercept = FALSE (although results may differ due different initializations residual_variance scaled_prior_variance). However, usage recommended situations. computational complexity susie \\(O(npL)\\) per iteration, whereas susie_suff_stat \\(O(p^2L)\\) per iteration (including cost computing sufficient statistics, dominated \\(O(np^2)\\) cost computing \\(X'X\\)). cost computing \\(X'X\\), susie usually faster. However, \\(n >> p\\), /\\(X'X\\) already computed, susie_suff_stat may faster.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sum of Single Effects (SuSiE) Regression — susie","text":"G. Wang, . Sarkar, P. Carbonetto M. Stephens (2020). simple new approach variable selection regression, application genetic fine-mapping. Journal Royal Statistical Society, Series B 82, 1273-1300 doi:10.1101/501114 . Y. Zou, P. Carbonetto, G. Wang, G M. Stephens (2022). Fine-mapping summary data “Sum Single Effects” model. PLoS Genetics 18, e1010299. doi:10.1371/journal.pgen.1010299 .","code":""},{"path":[]},{"path":"https://stephenslab.github.io/susieR/reference/susie.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sum of Single Effects (SuSiE) Regression — susie","text":"","code":"# susie example set.seed(1) n = 1000 p = 1000 beta = rep(0,p) beta[1:4] = 1 X = matrix(rnorm(n*p),nrow = n,ncol = p) X = scale(X,center = TRUE,scale = TRUE) y = drop(X %*% beta + rnorm(n)) res1 = susie(X,y,L = 10) susie_get_cs(res1) # extract credible sets from fit #> $cs #> $cs$L1 #> [1] 1 #>  #> $cs$L2 #> [1] 2 #>  #> $cs$L3 #> [1] 3 #>  #> $cs$L4 #> [1] 4 #>  #>  #> $coverage #> [1] 1 1 1 1 #>  #> $requested_coverage #> [1] 0.95 #>  plot(beta,coef(res1)[-1]) abline(a = 0,b = 1,col = \"skyblue\",lty = \"dashed\")  plot(y,predict(res1)) abline(a = 0,b = 1,col = \"skyblue\",lty = \"dashed\")   # susie_suff_stat example input_ss = compute_suff_stat(X,y) res2 = with(input_ss,             susie_suff_stat(XtX = XtX,Xty = Xty,yty = yty,n = n,                             X_colmeans = X_colmeans,y_mean = y_mean,L = 10)) plot(coef(res1),coef(res2)) abline(a = 0,b = 1,col = \"skyblue\",lty = \"dashed\")"},{"path":"https://stephenslab.github.io/susieR/reference/susieR-package.html","id":null,"dir":"Reference","previous_headings":"","what":"susieR: Sum of Single Effects Linear Regression — susieR-package","title":"susieR: Sum of Single Effects Linear Regression — susieR-package","text":"Implements methods variable selection linear regression based \"Sum Single Effects\" (SuSiE) model, described Wang et al (2020) doi:10.1101/501114  Zou et al (2021) doi:10.1101/2021.11.03.467167 . methods provide simple summaries, called \"Credible Sets\", accurately quantifying uncertainty variables selected. methods motivated genetic fine-mapping applications, particularly well-suited settings variables highly correlated detectable effects sparse. fitting algorithm, Bayesian analogue stepwise selection methods called \"Iterative Bayesian Stepwise Selection\" (IBSS), simple fast, allowing SuSiE model fit large data sets (thousands samples hundreds thousands variables).","code":""},{"path":[]},{"path":"https://stephenslab.github.io/susieR/reference/susieR-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"susieR: Sum of Single Effects Linear Regression — susieR-package","text":"Maintainer: Peter Carbonetto peter.carbonetto@gmail.com Authors: Gao Wang wang.gao@columbia.edu Yuxin Zou Kaiqian Zhang William R.P. Denault Matthew Stephens","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_auto.html","id":null,"dir":"Reference","previous_headings":"","what":"Attempt at Automating SuSiE for Hard Problems — susie_auto","title":"Attempt at Automating SuSiE for Hard Problems — susie_auto","text":"susie_auto attempt automate reliable   running susie even hard problems. implements three-stage   strategy L: first, fit susie small residual   error; next, estimate residual error; finally, estimate prior   variance. last step estimates prior variances   zero, stop. Otherwise, double L, repeat. Initial runs   performed relaxed tolerance; final run performed using   default susie tolerance.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_auto.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Attempt at Automating SuSiE for Hard Problems — susie_auto","text":"","code":"susie_auto(   X,   y,   L_init = 1,   L_max = 512,   verbose = FALSE,   init_tol = 1,   standardize = TRUE,   intercept = TRUE,   max_iter = 100,   tol = 0.01,   ... )"},{"path":"https://stephenslab.github.io/susieR/reference/susie_auto.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Attempt at Automating SuSiE for Hard Problems — susie_auto","text":"X n p matrix covariates. y observed responses, vector length n. L_init initial value L. L_max largest value L consider. verbose verbose = TRUE, algorithm's progress, summary optimization settings, printed console. init_tol tolerance passed susie early runs (set large shorten initial runs). standardize standardize = TRUE, standardize columns X unit variance prior fitting. Note scaled_prior_variance specifies prior coefficients X standardization (performed). standardize, may need think carefully specifying scaled_prior_variance. Whatever choice, coefficients returned coef given X original input scale. column X zero variance standardized. intercept intercept = TRUE, intercept fitted; intercept = FALSE, intercept set zero. Setting intercept = FALSE generally recommended. max_iter Maximum number IBSS iterations perform. tol small, non-negative number specifying convergence tolerance IBSS fitting procedure. fitting procedure halt difference variational lower bound, “ELBO” (objective function maximized), less tol. ... Additional arguments passed susie.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_auto.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Attempt at Automating SuSiE for Hard Problems — susie_auto","text":"See susie description return values.","code":""},{"path":[]},{"path":"https://stephenslab.github.io/susieR/reference/susie_auto.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Attempt at Automating SuSiE for Hard Problems — susie_auto","text":"","code":"set.seed(1) n = 1000 p = 1000 beta = rep(0,p) beta[1:4] = 1 X = matrix(rnorm(n*p),nrow = n,ncol = p) X = scale(X,center = TRUE,scale = TRUE) y = drop(X %*% beta + rnorm(n)) res = susie_auto(X,y) plot(beta,coef(res)[-1]) abline(a = 0,b = 1,col = \"skyblue\",lty = \"dashed\")  plot(y,predict(res)) abline(a = 0,b = 1,col = \"skyblue\",lty = \"dashed\")"},{"path":"https://stephenslab.github.io/susieR/reference/susie_get_methods.html","id":null,"dir":"Reference","previous_headings":"","what":"Inferences From Fitted SuSiE Model — susie_get_objective","title":"Inferences From Fitted SuSiE Model — susie_get_objective","text":"functions access basic properties draw   inferences fitted susie model.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_get_methods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inferences From Fitted SuSiE Model — susie_get_objective","text":"","code":"susie_get_objective(res, last_only = TRUE, warning_tol = 1e-06)  susie_get_posterior_mean(res, prior_tol = 1e-09)  susie_get_posterior_sd(res, prior_tol = 1e-09)  susie_get_niter(res)  susie_get_prior_variance(res)  susie_get_residual_variance(res)  susie_get_lfsr(res)  susie_get_posterior_samples(susie_fit, num_samples)  susie_get_cs(   res,   X = NULL,   Xcorr = NULL,   coverage = 0.95,   min_abs_corr = 0.5,   dedup = TRUE,   squared = FALSE,   check_symmetric = TRUE,   n_purity = 100,   use_rfast )  susie_get_pip(res, prune_by_cs = FALSE, prior_tol = 1e-09)"},{"path":"https://stephenslab.github.io/susieR/reference/susie_get_methods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inferences From Fitted SuSiE Model — susie_get_objective","text":"res susie fit, typically output susie one variants. susie_get_pip susie_get_cs, may instead posterior inclusion probability matrix, alpha. last_only last_only = FALSE, return ELBO iterations; otherwise return ELBO last iteration . warning_tol Warn ELBO decreasing tolerance level. prior_tol Filter effects estimated prior variance smaller threshold. susie_fit susie fit, output susie. num_samples number draws posterior distribution. X n p matrix values p variables (covariates) n samples. provided, correlation variables computed used remove CSs whose minimum correlation among variables smaller min_abs_corr. Xcorr p p matrix correlations variables (covariates). provided, used remove CSs whose minimum correlation among variables smaller min_abs_corr. coverage number 0 1 specifying desired coverage CS. min_abs_corr \"purity\" threshold CS. CS contains pair variables correlation less threshold filtered reported. dedup dedup = TRUE, remove duplicate CSs. squared squared = TRUE, report min, mean median squared correlation instead absolute correlation. check_symmetric check_symmetric = TRUE, perform check symmetry matrix Xcorr Xcorr provided (NULL). n_purity maximum number credible set (CS) variables used calculating correlation (“purity”) statistics. number variables included CS greater number, CS variables randomly subsampled. use_rfast Use Rfast package purity calculations. default use_rfast = TRUE Rfast package installed. prune_by_cs Whether ignore single effects reported CS calculating PIP.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_get_methods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inferences From Fitted SuSiE Model — susie_get_objective","text":"susie_get_objective returns evidence lower bound (ELBO) achieved fitted susie model , optionally, iteration IBSS fitting procedure. susie_get_residual_variance returns (estimated fixed) residual variance parameter. susie_get_prior_variance returns (estimated fixed) prior variance parameters. susie_get_posterior_mean returns posterior mean regression coefficients fitted susie model. susie_get_posterior_sd returns posterior standard deviation coefficients fitted susie model. susie_get_niter returns number model fitting iterations performed. susie_get_pip returns vector containing posterior inclusion probabilities (PIPs) variables. susie_get_lfsr returns vector containing average lfsr across variables single-effect, weighted posterior inclusion probability (alpha). susie_get_posterior_samples returns list containing effect sizes samples causal status two components: b, num_variables x num_samples matrix effect sizes; gamma, num_variables x num_samples matrix causal status random draws. susie_get_cs returns credible sets (CSs) susie fit, well summaries correlation among variables included CS. desired, one can filter CSs meet specified “purity” threshold; , either X Xcorr must supplied. returns list following elements: cs list list element vector containing   indices variables CS. coverage nominal coverage specified CS. purity X Xcorr iis provided),   purity CS. cs_index X Xcorr provided) index   (number 1 L) reported CS supplied susie   fit.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_get_methods.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Inferences From Fitted SuSiE Model — susie_get_objective","text":"","code":"set.seed(1) n = 1000 p = 1000 beta = rep(0,p) beta[1:4] = 1 X = matrix(rnorm(n*p),nrow = n,ncol = p) X = scale(X,center = TRUE,scale = TRUE) y = drop(X %*% beta + rnorm(n)) s = susie(X,y,L = 10) susie_get_objective(s) #> [1] -1455.415 susie_get_objective(s, last_only=FALSE) #> [1] -1927.147 -1477.646 -1455.416 -1455.415 susie_get_residual_variance(s) #> [1] 0.9899176 susie_get_prior_variance(s) #>  [1] 1.132713 1.049537 1.009391 0.978421 0.000000 0.000000 0.000000 0.000000 #>  [9] 0.000000 0.000000 susie_get_posterior_mean(s) #>    [1]   1.063825e+00   1.023986e+00   1.004192e+00   9.886512e-01 #>    [5] -8.453416e-217 -1.417151e-213  1.201583e-214  4.561724e-216 #>    [9]  1.734347e-216 -4.657946e-217  2.154023e-216  5.614509e-216 #>   [13]  1.119569e-216  2.862909e-216 -1.153959e-216  1.523149e-218 #>   [17]  1.217335e-215  2.957793e-215  2.873810e-216 -3.406048e-216 #>   [21] -4.755227e-215 -1.673622e-215  2.574856e-215 -4.179136e-216 #>   [25]  5.353780e-216 -1.397719e-216  9.686463e-217  1.577200e-217 #>   [29]  5.922135e-217 -1.357500e-216 -2.468809e-217  8.746227e-214 #>   [33]  8.298402e-217 -6.323162e-217 -4.608892e-217  1.160039e-212 #>   [37]  3.594643e-217 -3.884377e-216 -1.543913e-216  4.805638e-216 #>   [41]  5.560123e-217  9.512582e-218 -9.188204e-217 -9.134336e-216 #>   [45] -5.319250e-216  1.607871e-213 -6.428401e-215  2.395144e-216 #>   [49] -2.447378e-217  3.164270e-215 -1.420230e-215 -2.330788e-217 #>   [53]  1.873140e-217 -1.018681e-216  1.511235e-216  4.938063e-216 #>   [57]  7.497066e-217 -5.945768e-217 -6.349095e-216  1.211021e-215 #>   [61]  7.046491e-217 -2.809440e-215  3.566071e-217 -6.749749e-217 #>   [65] -2.882037e-217  5.030366e-217  1.203192e-215  1.894047e-216 #>   [69] -1.304107e-212  5.338714e-217  8.686288e-216  1.800492e-214 #>   [73]  2.853655e-217 -5.237734e-215 -3.620615e-216 -4.332929e-217 #>   [77]  1.144477e-216  1.609066e-215  4.164065e-214 -2.362128e-215 #>   [81] -7.197737e-217  6.354672e-217  4.804369e-216 -1.580831e-217 #>   [85]  3.802540e-216 -3.296371e-216 -3.714979e-218  6.676896e-217 #>   [89] -3.205994e-216  2.746267e-216 -4.360117e-216 -5.908594e-215 #>   [93]  6.768711e-217  1.817145e-216 -4.795225e-217  8.461871e-217 #>   [97] -7.122764e-217  1.489106e-215 -8.621147e-216 -1.363945e-216 #>  [101]  1.711542e-217  8.756724e-216 -1.906718e-214 -1.911585e-216 #>  [105]  3.787328e-216  3.310293e-214 -1.766390e-216 -5.336149e-216 #>  [109]  6.925433e-217  2.332834e-216  4.733749e-217  2.230102e-215 #>  [113] -6.674221e-216  3.677889e-218  5.456026e-216  1.432486e-216 #>  [117] -2.773765e-217  1.210457e-216 -9.883161e-217  7.835604e-216 #>  [121]  4.984243e-217 -1.352101e-216  8.744269e-217 -1.518912e-215 #>  [125]  9.001101e-217 -7.813815e-217 -1.198923e-215  4.466498e-216 #>  [129]  6.151252e-217  3.081636e-215  2.764383e-215  5.335474e-217 #>  [133] -4.453473e-217 -3.049091e-214  3.333238e-217  4.059981e-217 #>  [137]  6.812472e-218 -3.098747e-216  5.098449e-216  5.813210e-217 #>  [141] -5.065428e-217  1.005287e-216  3.097972e-217 -5.377436e-217 #>  [145] -1.027776e-216 -1.438676e-215  1.518813e-214  1.169116e-216 #>  [149]  4.908787e-216 -5.611278e-216  3.415806e-217  1.954231e-216 #>  [153]  2.989363e-216  5.507984e-217  2.090598e-217 -2.407923e-215 #>  [157] -1.364342e-216 -2.111521e-216 -1.135603e-215 -1.625525e-216 #>  [161] -9.847531e-217 -9.760085e-215 -1.406766e-214  4.288097e-217 #>  [165] -3.570655e-216  7.880394e-215 -6.005368e-217  1.886486e-217 #>  [169]  4.400035e-216  1.916334e-214  2.074352e-216  7.297416e-217 #>  [173] -3.007515e-216 -2.471356e-216 -5.288808e-216 -7.911514e-217 #>  [177] -2.158625e-216  2.344281e-215 -3.252106e-216  7.732716e-215 #>  [181]  1.056887e-217 -8.223976e-216 -1.835361e-216  2.387140e-216 #>  [185]  1.495170e-215  2.547701e-217 -3.763749e-215 -1.203568e-217 #>  [189] -1.795721e-216 -2.285112e-215 -4.364788e-217 -1.153756e-216 #>  [193]  7.928309e-216  2.672654e-217  3.477151e-217 -1.766857e-216 #>  [197] -1.096530e-216 -2.950116e-216 -1.045740e-216  1.260164e-216 #>  [201]  5.503766e-216 -2.288041e-214  1.017713e-216 -4.558442e-215 #>  [205]  3.710221e-215 -7.383942e-217  3.731530e-216  1.204640e-215 #>  [209] -1.100836e-217 -2.296265e-215 -8.247191e-217  3.225623e-218 #>  [213] -1.082281e-216 -1.358979e-213 -4.782181e-216 -1.531988e-217 #>  [217] -1.732410e-214 -5.208158e-216  1.604457e-215 -1.356742e-217 #>  [221] -8.577181e-217 -8.091139e-217 -8.123133e-217  7.593254e-217 #>  [225] -6.029480e-216  1.186547e-216  2.929144e-216 -1.593338e-215 #>  [229] -6.386229e-216 -4.185052e-213  2.568616e-216 -1.211651e-216 #>  [233]  2.457526e-216  8.303359e-216  1.862521e-215 -3.387282e-216 #>  [237]  1.660586e-217 -9.643088e-216  5.009112e-216 -1.762933e-215 #>  [241]  6.913823e-217 -9.056835e-218  8.903106e-216  4.776681e-216 #>  [245]  7.994142e-217  3.788216e-215  4.257167e-217 -1.321800e-216 #>  [249]  5.918243e-218  1.740664e-216 -5.330869e-217  1.515586e-217 #>  [253] -1.208393e-216 -1.322063e-216 -4.289292e-217  2.334949e-216 #>  [257]  4.526367e-217 -7.226022e-217  4.873803e-217  4.105104e-217 #>  [261] -1.126485e-216 -4.643134e-217 -5.811264e-217 -6.008250e-216 #>  [265]  2.122859e-215  2.595463e-217 -5.697126e-216 -1.808049e-216 #>  [269]  3.315668e-216  2.289490e-216 -1.476663e-216 -1.635013e-217 #>  [273] -1.439169e-212 -2.937969e-217  2.574745e-213 -1.464897e-216 #>  [277]  1.349383e-216  6.644532e-219 -3.520317e-216  2.706193e-216 #>  [281] -1.906314e-215 -8.881822e-216  8.199133e-217 -3.244942e-216 #>  [285]  1.364082e-218 -2.395516e-218 -1.865011e-216  2.516864e-217 #>  [289] -8.450956e-218  8.602545e-217 -1.163393e-217  1.603950e-214 #>  [293] -4.195476e-217  2.919372e-217 -2.790205e-216  4.070217e-216 #>  [297] -4.880283e-215 -8.955565e-216  5.084957e-217  3.924742e-216 #>  [301] -3.890152e-218 -9.458992e-217  9.715167e-213 -1.212440e-216 #>  [305]  7.153850e-217 -3.993466e-216  7.714205e-216 -2.997400e-216 #>  [309] -2.600955e-215  2.138881e-216  7.738079e-217 -6.063984e-219 #>  [313]  1.043388e-216  1.165383e-216  4.819641e-216  1.804675e-215 #>  [317] -4.074580e-216  3.446046e-216  3.054390e-212 -1.346184e-216 #>  [321]  4.548667e-217 -1.006963e-215  9.171383e-218  6.648108e-216 #>  [325] -6.458434e-217  3.211285e-215 -2.142650e-216  6.247990e-217 #>  [329] -1.096480e-215 -1.588109e-216  2.121316e-217  1.633976e-215 #>  [333]  6.041247e-216  6.387666e-218  1.307924e-217  6.461390e-215 #>  [337] -8.266950e-216  4.563527e-216  1.617164e-217 -1.132624e-216 #>  [341]  5.228957e-216 -2.475274e-217  3.229269e-216 -7.204623e-216 #>  [345]  8.456075e-217  1.557069e-214  4.271069e-216 -1.606357e-216 #>  [349]  1.617610e-217  8.311647e-216  3.267844e-216 -3.657800e-216 #>  [353]  6.368637e-216 -4.042059e-215  1.207844e-215 -6.174982e-217 #>  [357] -9.995589e-215 -1.110565e-216 -7.324852e-214 -1.242884e-217 #>  [361] -3.295606e-215  1.705821e-215  2.573258e-218 -2.298261e-214 #>  [365] -9.716228e-215 -2.964152e-216 -1.208990e-216  1.434601e-216 #>  [369]  3.266586e-215  5.341371e-217 -7.211391e-216  1.982229e-217 #>  [373]  8.752747e-217 -4.584595e-215  1.291725e-216  2.719278e-218 #>  [377] -5.300151e-216  5.186464e-216 -2.882413e-216  8.720335e-216 #>  [381] -5.496038e-217 -1.586379e-216  8.672701e-214  3.471245e-217 #>  [385] -1.459058e-214  2.768301e-217 -1.154042e-216 -2.106037e-216 #>  [389] -7.965321e-218  4.590662e-217  1.158414e-214  1.433776e-216 #>  [393] -7.785828e-217 -6.112129e-217  7.356650e-217 -5.242807e-216 #>  [397] -1.568227e-213  5.712025e-217  7.236770e-218  1.538676e-215 #>  [401]  1.577647e-216 -2.140943e-216  2.737315e-216 -1.428319e-215 #>  [405]  3.914283e-217 -1.835093e-216 -3.290047e-216 -5.780672e-217 #>  [409] -6.155320e-215 -3.402409e-216 -3.677303e-216  1.315248e-216 #>  [413]  4.344609e-216  4.521614e-217 -8.248374e-215 -1.721434e-216 #>  [417] -3.842479e-216  1.385441e-215 -1.799752e-216 -8.137430e-214 #>  [421]  7.291286e-216  2.836489e-216  2.883508e-216 -4.488321e-217 #>  [425] -3.740672e-216 -6.679845e-216  5.023562e-217 -1.755977e-215 #>  [429]  4.303306e-216 -1.937935e-216 -3.806384e-217  3.832329e-217 #>  [433]  1.657362e-214  1.955964e-216  2.881432e-216 -1.846103e-216 #>  [437]  2.414691e-216  1.003296e-216  5.749078e-217 -1.897208e-216 #>  [441]  2.137203e-216  4.608212e-217 -1.843146e-216 -3.532281e-216 #>  [445] -1.095628e-215 -4.184548e-217 -2.491527e-217 -9.836119e-216 #>  [449]  2.717185e-217  1.109231e-216 -4.323917e-214 -2.981151e-216 #>  [453]  4.333319e-216  1.053529e-216  9.364600e-216  1.832128e-216 #>  [457]  4.113126e-215 -3.087183e-216  3.701263e-215 -3.374066e-216 #>  [461]  1.059537e-215  7.329713e-216 -2.977083e-216  1.622697e-216 #>  [465] -2.115836e-217  7.261185e-217 -4.885790e-217  5.658757e-216 #>  [469]  1.701756e-215  2.197174e-215 -7.433406e-216  1.298488e-216 #>  [473] -2.672121e-216  3.721317e-218  3.769903e-216 -1.537263e-216 #>  [477] -3.986902e-216  1.566943e-215 -9.148298e-217  1.835966e-216 #>  [481] -1.165385e-215 -4.961478e-215  1.089097e-215 -6.668232e-217 #>  [485]  2.001819e-217 -1.649975e-213 -1.703184e-216 -8.430522e-217 #>  [489] -6.197190e-216 -3.554246e-215 -8.757716e-217 -6.050441e-217 #>  [493]  1.406671e-217 -5.778929e-216  5.221640e-218 -1.207028e-216 #>  [497]  1.236405e-216  9.301018e-217 -7.571449e-217  1.005966e-215 #>  [501]  2.852615e-217 -4.659667e-215  2.067395e-215  3.179569e-217 #>  [505]  4.636637e-217 -8.934885e-217 -1.908562e-217  2.096515e-216 #>  [509] -4.628876e-216  3.938280e-216 -1.674374e-215 -5.240854e-215 #>  [513]  2.083724e-216  4.788555e-218 -1.149079e-214 -1.859830e-215 #>  [517]  3.040875e-216  1.632337e-216 -1.175233e-214 -7.497011e-217 #>  [521]  5.920520e-218 -4.512253e-216 -2.940845e-218  7.981815e-218 #>  [525]  9.944307e-217  1.933513e-214  4.159092e-217 -6.898471e-217 #>  [529]  3.398976e-215 -2.642470e-216  7.784348e-216  4.274897e-216 #>  [533] -4.109507e-214 -1.987659e-216  5.944979e-217  1.339260e-216 #>  [537] -4.732178e-216  1.076050e-216 -4.003456e-216 -5.017297e-217 #>  [541]  1.605572e-218  2.404383e-216 -6.844595e-219 -5.627016e-216 #>  [545]  2.535615e-216 -1.176805e-216 -1.030738e-216  5.228333e-216 #>  [549]  1.363719e-213  1.781139e-216  1.264844e-216 -5.776243e-217 #>  [553] -9.490409e-217 -1.345139e-214 -2.059103e-211  8.441850e-217 #>  [557]  1.580856e-217  3.422738e-216  1.414511e-216  4.247428e-216 #>  [561]  8.564411e-217 -4.448577e-216  4.525635e-217  8.186770e-217 #>  [565]  3.359225e-214 -4.654940e-217 -4.593802e-216 -4.402906e-215 #>  [569]  6.124091e-216  3.391552e-217 -2.741471e-215 -6.880474e-216 #>  [573] -6.872535e-217 -7.491578e-217  3.127045e-216  3.579982e-217 #>  [577]  4.039908e-216  2.167479e-216  2.650572e-216 -9.423535e-218 #>  [581]  2.644900e-216  4.085466e-216 -2.096888e-216  4.238986e-216 #>  [585] -2.250166e-216 -1.455199e-215 -2.185123e-217  1.106997e-216 #>  [589]  2.801556e-217  6.746333e-216  6.531352e-216 -4.162829e-216 #>  [593]  4.141768e-216  4.829666e-214 -1.513988e-216 -3.472103e-216 #>  [597]  2.116471e-216  1.161767e-217  1.416050e-216  2.052074e-215 #>  [601] -6.662535e-218  1.022159e-216  2.033348e-215  4.219852e-217 #>  [605]  7.623675e-216  1.115568e-216  1.296444e-217 -1.332073e-215 #>  [609]  3.169995e-217  1.670617e-215  3.153569e-217  3.557483e-211 #>  [613] -5.449887e-217 -6.054374e-216 -6.966711e-218 -1.567849e-216 #>  [617] -6.441374e-217  2.593736e-215 -1.153667e-215  4.526473e-217 #>  [621]  9.337272e-216  9.792551e-217 -4.076786e-217 -1.222130e-214 #>  [625] -2.757835e-215 -1.959382e-215 -1.570916e-216  6.619632e-216 #>  [629] -1.548267e-216 -1.437344e-217 -1.592390e-215  4.920118e-217 #>  [633] -4.120101e-216 -6.558110e-217  1.317222e-216 -8.103479e-215 #>  [637]  4.865120e-216 -1.229402e-216  3.073763e-217 -9.862812e-216 #>  [641]  5.901299e-215  7.798518e-218 -4.146195e-213 -6.453182e-216 #>  [645]  2.409365e-217 -5.737021e-217 -2.461369e-217 -1.445973e-216 #>  [649]  2.617054e-216 -1.818299e-216  5.528300e-217  4.256421e-217 #>  [653]  2.483329e-216 -1.257865e-217  6.052209e-216 -9.544616e-217 #>  [657] -9.766109e-217  6.115016e-216 -2.390106e-217  6.727624e-217 #>  [661]  9.469454e-216  2.349519e-217 -7.239949e-215  1.219901e-216 #>  [665]  1.427140e-216  6.119766e-217 -3.008555e-216 -6.908254e-217 #>  [669] -9.117257e-217  1.275996e-216  1.378863e-215 -5.334567e-218 #>  [673]  1.853146e-216 -3.208341e-217  4.037936e-217  6.813843e-217 #>  [677]  1.503606e-217 -1.191158e-216 -1.132159e-217  7.253271e-216 #>  [681]  6.948191e-217  7.273466e-216 -3.307361e-216 -8.054776e-217 #>  [685] -2.168044e-216 -1.693032e-213 -1.422252e-216 -2.857733e-218 #>  [689]  1.530881e-213  1.589734e-216  3.052321e-215  3.558237e-216 #>  [693]  2.195097e-217  1.192190e-216 -4.439871e-217 -8.613446e-217 #>  [697] -4.416606e-219  1.758333e-217  2.841791e-216 -9.494769e-217 #>  [701] -1.482531e-215 -1.283965e-215 -1.953802e-216  1.048496e-216 #>  [705]  1.399608e-216  1.026791e-215  9.450734e-216  8.969975e-217 #>  [709] -3.023248e-216 -3.223879e-215  6.141157e-215  1.178430e-214 #>  [713]  8.438564e-217 -3.838199e-216  1.761639e-216 -4.924419e-215 #>  [717]  4.114684e-216 -1.508014e-216 -8.554463e-217 -7.505988e-216 #>  [721]  5.486081e-217  1.231488e-216 -6.691354e-217  5.906285e-215 #>  [725] -2.106497e-216  2.606914e-217 -8.026654e-215 -9.365268e-214 #>  [729]  7.215046e-219  1.640751e-216 -1.805976e-216  2.752813e-213 #>  [733] -1.465475e-216 -6.659035e-216 -7.030432e-216 -7.845624e-217 #>  [737] -3.814659e-216  7.516720e-216 -2.882546e-216  1.414592e-216 #>  [741] -6.470588e-216 -5.246481e-217  4.287105e-217  3.422964e-218 #>  [745]  1.364086e-215 -2.817717e-215 -1.072754e-216 -4.543846e-216 #>  [749] -1.911205e-215  8.147229e-217  3.263967e-216 -6.613132e-216 #>  [753]  5.651580e-217 -5.788865e-217 -2.997883e-217 -4.056275e-216 #>  [757] -3.204553e-215  2.776173e-214 -6.440736e-218  2.078325e-215 #>  [761]  2.183368e-217  1.193334e-216 -6.353778e-215  2.216590e-216 #>  [765] -1.604963e-215  2.376875e-214  1.572423e-216  5.473849e-216 #>  [769] -1.411755e-216  5.223751e-217  1.144416e-215  3.239200e-216 #>  [773] -1.685752e-216  1.325392e-213 -2.970639e-217  1.138729e-218 #>  [777]  1.614578e-216 -2.817050e-216 -3.192133e-216  2.331554e-216 #>  [781]  6.888753e-217  1.205403e-216  3.018058e-216  1.632304e-216 #>  [785] -2.164261e-215 -3.443764e-217  2.416939e-216  5.417462e-217 #>  [789] -1.193062e-215  1.159254e-217 -2.610390e-216  4.060786e-216 #>  [793] -3.732159e-214  8.425381e-218  1.093886e-215 -4.506839e-217 #>  [797] -7.879620e-216 -3.166866e-215 -7.731182e-215 -4.618741e-216 #>  [801]  5.272546e-217  8.357745e-215 -1.211012e-216  2.179007e-216 #>  [805] -3.601223e-217 -9.032682e-217  8.011898e-217  4.437618e-217 #>  [809] -1.060856e-215  3.954313e-215  1.134040e-216  1.202711e-215 #>  [813]  6.195694e-216  1.627931e-216 -3.270156e-216 -2.701018e-217 #>  [817] -2.189186e-216  1.881536e-214  4.401764e-217 -3.260919e-215 #>  [821] -8.171759e-216 -1.043047e-215 -3.726179e-217 -4.258362e-216 #>  [825] -3.902257e-216 -3.641678e-216 -1.758922e-217 -5.188605e-217 #>  [829]  1.245528e-217  5.659281e-217  5.509489e-216 -6.699349e-216 #>  [833]  2.866548e-215  1.766867e-216  1.683123e-217  3.720970e-217 #>  [837] -9.503680e-217 -1.043348e-216  5.944579e-216  1.680247e-216 #>  [841] -2.593312e-216  2.451304e-216  2.324848e-216  1.615977e-216 #>  [845]  6.039326e-216  1.945627e-216 -2.620956e-217 -2.445990e-216 #>  [849]  2.468816e-216  1.497642e-217  4.117312e-217  3.279991e-215 #>  [853]  1.271709e-217  2.448701e-216  5.139089e-217 -2.443482e-215 #>  [857]  1.789110e-217  6.552099e-217  2.466118e-216 -8.745182e-216 #>  [861] -3.365772e-216 -2.214994e-217  3.186700e-215 -2.272083e-217 #>  [865]  2.155556e-216  5.080271e-216 -1.273605e-215  5.331571e-217 #>  [869] -1.837609e-216  5.547521e-216 -3.494234e-217 -2.837869e-216 #>  [873] -1.103410e-215 -2.322071e-216  1.421035e-216  7.949849e-217 #>  [877]  8.452882e-216  9.112562e-215  3.034474e-217 -1.781216e-217 #>  [881]  5.150989e-216 -1.793767e-216  1.182358e-215  5.064351e-217 #>  [885] -4.208904e-216 -1.511314e-217 -2.603377e-216 -1.594495e-217 #>  [889]  4.201508e-217  8.253568e-217 -1.810559e-215  7.633346e-217 #>  [893] -1.539724e-216 -2.191629e-217 -1.163739e-217  2.038968e-216 #>  [897]  6.114693e-215 -6.187612e-215 -3.951902e-216 -8.386076e-217 #>  [901]  1.071789e-214  1.342111e-216  1.288173e-215  5.224519e-216 #>  [905] -1.347737e-215 -7.381100e-215 -3.411162e-216  6.116849e-216 #>  [909] -1.147600e-216  1.428939e-216 -4.739473e-217 -2.171298e-216 #>  [913] -1.741950e-216  1.018736e-215  7.904035e-213  2.302359e-218 #>  [917] -4.384966e-217 -1.061610e-217 -1.014233e-216 -2.020908e-216 #>  [921] -2.222052e-216 -1.554296e-216  8.252241e-216  3.375281e-217 #>  [925] -3.747266e-217  1.712992e-217 -1.045983e-217 -1.747777e-217 #>  [929] -4.349827e-217 -3.280187e-215  2.438763e-216 -4.339318e-216 #>  [933]  6.350826e-216 -2.825334e-213  1.634378e-216  1.070040e-217 #>  [937] -2.001690e-216 -1.814303e-216  2.827265e-216 -5.622449e-216 #>  [941] -3.668116e-217  5.850695e-216 -2.138384e-217  1.392341e-216 #>  [945] -2.552108e-214 -4.220075e-216  3.835893e-215  7.466543e-217 #>  [949]  3.763897e-218  2.732076e-216 -5.216961e-217 -4.601935e-216 #>  [953]  8.364992e-217 -1.252098e-216  1.053079e-216 -2.537830e-217 #>  [957] -8.971744e-217  2.474750e-218 -3.767368e-215 -5.089541e-216 #>  [961]  1.676999e-215  2.307456e-216  2.327568e-216 -6.005896e-216 #>  [965] -4.528749e-215  1.421242e-217 -6.984570e-213  1.627735e-217 #>  [969] -3.267888e-217 -3.994392e-217  5.126129e-217 -4.328507e-217 #>  [973]  2.386807e-217 -3.940193e-215 -7.916160e-216 -1.818064e-216 #>  [977] -8.942952e-214  1.075354e-217  1.240179e-216  1.810859e-215 #>  [981]  8.493123e-217 -8.260577e-216  4.701119e-217 -1.600956e-215 #>  [985] -7.170516e-217  1.894373e-217 -1.180732e-216 -6.570960e-217 #>  [989] -2.003210e-216 -7.259567e-216 -1.256882e-216  1.892978e-216 #>  [993] -3.396743e-214 -1.739134e-215  7.822050e-218  9.530524e-214 #>  [997] -7.282605e-217  2.477154e-216 -1.299976e-216  1.246133e-214 susie_get_posterior_sd(s) #>    [1]  3.146494e-02  3.146385e-02  3.146326e-02  3.146277e-02 2.471927e-109 #>    [6] 1.285636e-107 3.399189e-108 5.508878e-109 3.308551e-109 2.150000e-109 #>   [11] 3.682613e-109 6.184568e-109 2.730881e-109 4.271947e-109 2.763642e-109 #>   [16] 1.961004e-109 9.552289e-109 1.569790e-108 4.280621e-109 4.691272e-109 #>   [21] 2.042720e-108 1.142114e-108 1.453124e-108 5.248127e-109 6.022398e-109 #>   [26] 2.995420e-109 2.587348e-109 1.984895e-109 2.248339e-109 2.957375e-109 #>   [31] 2.018592e-109 9.934418e-108 2.457562e-109 2.281847e-109 2.146493e-109 #>   [36] 3.914998e-107 2.078700e-109 5.040843e-109 3.132686e-109 5.670599e-109 #>   [41] 2.218948e-109 1.969636e-109 2.540383e-109 8.127608e-109 6.000684e-109 #>   [46] 1.375137e-107 2.412336e-108 3.888876e-109 2.017628e-109 1.629827e-108 #>   [51] 1.041631e-108 2.012511e-109 1.994950e-109 2.634748e-109 3.102153e-109 #>   [56] 5.757020e-109 2.384542e-109 2.250284e-109 6.625328e-109 9.524888e-109 #>   [61] 2.344430e-109 1.525462e-108 2.076962e-109 2.318453e-109 2.038559e-109 #>   [66] 2.177647e-109 9.489752e-109 3.453152e-109 4.163831e-107 2.201424e-109 #>   [71] 7.900908e-109 4.237004e-108 2.037105e-109 2.154743e-108 4.850201e-109 #>   [76] 2.126927e-109 2.754594e-109 1.117201e-108 6.669216e-108 1.384880e-108 #>   [81] 2.357804e-109 2.284521e-109 5.669769e-109 1.985002e-109 4.982226e-109 #>   [86] 4.608657e-109 1.962133e-109 2.312138e-109 4.539775e-109 4.178438e-109 #>   [91] 5.372594e-109 2.302857e-108 2.320101e-109 3.383861e-109 2.160047e-109 #>   [96] 2.472638e-109 2.351160e-109 1.069688e-108 7.867529e-109 2.963479e-109 #>  [101] 1.989099e-109 7.936879e-109 4.371043e-108 3.468863e-109 4.971279e-109 #>  [106] 5.892852e-108 3.337782e-109 6.011318e-109 2.333783e-109 3.836167e-109 #>  [111] 2.155526e-109 1.341112e-108 6.813541e-109 1.962106e-109 6.086362e-109 #>  [116] 3.028217e-109 2.033081e-109 2.817545e-109 2.605946e-109 7.456025e-109 #>  [121] 2.174157e-109 2.952263e-109 2.498861e-109 1.081649e-108 2.522842e-109 #>  [126] 2.413171e-109 9.470813e-109 5.444810e-109 2.267367e-109 1.606021e-108 #>  [131] 1.511788e-108 2.201171e-109 2.135362e-109 5.636925e-108 2.063186e-109 #>  [136] 2.108389e-109 1.965332e-109 4.457172e-109 5.860443e-109 2.239410e-109 #>  [141] 2.180313e-109 2.622035e-109 2.050016e-109 2.204463e-109 2.643389e-109 #>  [146] 1.049204e-108 3.862446e-108 2.778106e-109 5.737995e-109 6.182549e-109 #>  [151] 2.067996e-109 3.506930e-109 4.371888e-109 2.214789e-109 2.002663e-109 #>  [156] 1.399800e-108 2.963854e-109 3.645605e-109 9.186286e-109 3.208488e-109 #>  [161] 2.602571e-109 3.033887e-108 3.704501e-108 2.123826e-109 4.813514e-109 #>  [166] 2.698127e-108 2.255213e-109 1.995053e-109 5.399773e-109 4.383017e-108 #>  [171] 3.613080e-109 2.366671e-109 4.386127e-109 3.952789e-109 6.200176e-109 #>  [176] 2.422064e-109 3.686608e-109 1.379030e-108 4.574988e-109 2.670244e-108 #>  [181] 1.971698e-109 7.661598e-109 3.400332e-109 3.882127e-109 1.072130e-108 #>  [186] 2.022203e-109 1.794651e-108 1.974911e-109 3.364449e-109 1.359488e-108 #>  [191] 2.129147e-109 2.763449e-109 7.505488e-109 2.028118e-109 2.071619e-109 #>  [196] 3.338207e-109 2.708854e-109 4.341028e-109 2.660471e-109 2.864916e-109 #>  [201] 6.116058e-109 4.825547e-108 2.633828e-109 1.995535e-108 1.780449e-108 #>  [206] 2.374398e-109 4.930982e-109 9.496173e-109 1.972618e-109 1.363189e-108 #>  [211] 2.452820e-109 1.961936e-109 2.695276e-109 1.257214e-107 5.655192e-109 #>  [216] 1.983550e-109 4.149143e-108 5.930428e-109 1.115406e-108 1.978695e-109 #>  [221] 2.483325e-109 2.438484e-109 2.441428e-109 2.393201e-109 6.436311e-109 #>  [226] 2.794738e-109 4.324483e-109 1.111064e-108 6.647027e-109 2.285459e-107 #>  [231] 4.034097e-109 2.818684e-109 3.941235e-109 7.703096e-109 1.212616e-108 #>  [236] 4.677200e-109 1.987466e-109 8.379217e-109 5.803000e-109 1.175870e-108 #>  [241] 2.332765e-109 1.968816e-109 8.011233e-109 5.651574e-109 2.429619e-109 #>  [246] 1.801127e-108 2.121700e-109 2.923521e-109 1.964217e-109 3.314323e-109 #>  [251] 2.200812e-109 1.983072e-109 2.815587e-109 2.923770e-109 2.124115e-109 #>  [256] 3.837963e-109 2.140535e-109 2.360317e-109 2.165875e-109 2.111393e-109 #>  [261] 2.737426e-109 2.149134e-109 2.239244e-109 6.423610e-109 1.304686e-108 #>  [266] 2.024436e-109 6.235265e-109 3.375623e-109 4.623237e-109 3.799261e-109 #>  [271] 3.069757e-109 1.986663e-109 4.385404e-107 2.041456e-109 1.766488e-107 #>  [276] 3.058708e-109 2.949684e-109 1.960820e-109 4.776357e-109 4.146011e-109 #>  [281] 1.228493e-108 8.000455e-109 2.448401e-109 4.569529e-109 1.960958e-109 #>  [286] 1.961340e-109 3.427065e-109 2.020792e-109 1.967778e-109 2.485680e-109 #>  [291] 1.973991e-109 3.978845e-108 2.117489e-109 2.040488e-109 4.213814e-109 #>  [296] 5.172211e-109 2.072239e-108 8.037749e-109 2.181801e-109 5.069571e-109 #>  [301] 1.962264e-109 2.565859e-109 3.565816e-107 2.819448e-109 2.353912e-109 #>  [306] 5.118236e-109 7.390870e-109 4.378191e-109 1.461316e-108 3.669451e-109 #>  [311] 2.406299e-109 1.960811e-109 2.658233e-109 2.774544e-109 5.679783e-109 #>  [316] 1.191383e-108 5.175263e-109 4.721172e-109 6.510489e-107 2.946652e-109 #>  [321] 2.142126e-109 8.585721e-109 1.969106e-109 6.798568e-109 2.293355e-109 #>  [326] 1.643245e-108 3.672729e-109 2.275495e-109 9.006967e-109 3.173811e-109 #>  [331] 2.003874e-109 1.126865e-108 6.443343e-109 1.964783e-109 1.977441e-109 #>  [336] 2.419143e-108 7.684087e-109 5.510086e-109 1.986112e-109 2.743284e-109 #>  [341] 5.943627e-109 2.018884e-109 4.557571e-109 7.112437e-109 2.472101e-109 #>  [346] 3.915116e-108 5.311611e-109 3.190740e-109 1.986124e-109 7.707419e-109 #>  [351] 4.586966e-109 4.877385e-109 6.636754e-109 1.867043e-108 9.510358e-109 #>  [356] 2.269356e-109 3.073745e-108 2.722239e-109 9.034109e-108 1.975840e-109 #>  [361] 1.667085e-108 1.154373e-108 1.961427e-109 4.837218e-108 3.026415e-108 #>  [366] 4.352080e-109 2.816148e-109 3.030210e-109 1.658912e-108 2.201633e-109 #>  [371] 7.116189e-109 1.999146e-109 2.499652e-109 2.001859e-108 2.894946e-109 #>  [376] 1.961509e-109 5.988648e-109 5.916636e-109 4.287458e-109 7.918311e-109 #>  [381] 2.213839e-109 3.172205e-109 9.889626e-108 2.071268e-109 3.778918e-108 #>  [386] 2.032807e-109 2.763722e-109 3.640846e-109 1.966999e-109 2.145138e-109 #>  [391] 3.331932e-108 3.029432e-109 2.410628e-109 2.264149e-109 2.371958e-109 #>  [396] 5.952405e-109 1.356966e-107 2.231183e-109 1.965915e-109 1.089522e-108 #>  [401] 3.164091e-109 3.671244e-109 4.171207e-109 1.044957e-108 2.098818e-109 #>  [406] 3.400090e-109 4.603830e-109 2.236753e-109 2.355354e-108 4.688545e-109 #>  [411] 4.891602e-109 2.917299e-109 5.362009e-109 2.140195e-109 2.766566e-108 #>  [416] 3.296740e-109 5.010888e-109 1.027228e-108 3.368102e-109 9.557973e-108 #>  [421] 7.160371e-109 4.250883e-109 4.288327e-109 2.137828e-109 4.937600e-109 #>  [426] 6.816760e-109 2.177132e-109 1.173268e-108 5.333744e-109 3.492408e-109 #>  [431] 2.091891e-109 2.093546e-109 4.050401e-108 3.508472e-109 4.286679e-109 #>  [436] 3.410035e-109 3.905325e-109 2.620145e-109 2.234179e-109 3.455986e-109 #>  [441] 3.667991e-109 2.146403e-109 3.407361e-109 4.785207e-109 9.003032e-109 #>  [446] 2.116747e-109 2.019622e-109 8.473156e-109 2.030284e-109 2.720966e-109 #>  [451] 6.805930e-108 4.365443e-109 5.354294e-109 2.667884e-109 8.242227e-109 #>  [456] 3.397412e-109 1.885157e-108 4.448206e-109 1.778064e-108 4.667273e-109 #>  [461] 8.835032e-109 7.181547e-109 4.362247e-109 3.205872e-109 2.003658e-109 #>  [466] 2.363448e-109 2.166769e-109 6.211746e-109 1.152841e-108 1.330023e-108 #>  [471] 7.238453e-109 2.901375e-109 4.118317e-109 1.962138e-109 4.958719e-109 #>  [476] 3.126476e-109 5.113602e-109 1.100704e-108 2.536637e-109 3.400879e-109 #>  [481] 9.320963e-109 2.091218e-108 8.972815e-109 2.311389e-109 1.999266e-109 #>  [486] 1.394204e-107 3.280019e-109 2.469737e-109 6.536010e-109 1.738520e-108 #>  [491] 2.500118e-109 2.258955e-109 1.980020e-109 6.285192e-109 1.963456e-109 #>  [496] 2.814276e-109 2.842283e-109 2.550984e-109 2.391235e-109 8.580938e-109 #>  [501] 2.037052e-109 2.019921e-108 1.285520e-108 2.054484e-109 2.148462e-109 #>  [506] 2.516648e-109 1.995842e-109 3.632533e-109 5.553738e-109 5.079183e-109 #>  [511] 1.142398e-108 2.155452e-108 3.621298e-109 1.963051e-109 3.317234e-108 #>  [516] 1.211635e-108 4.412183e-109 3.214787e-109 3.358272e-108 2.384540e-109 #>  [521] 1.964221e-109 5.475660e-109 1.961628e-109 1.967024e-109 2.611741e-109 #>  [526] 4.404296e-108 2.115025e-109 2.331421e-109 1.695933e-108 4.094125e-109 #>  [531] 7.428570e-109 5.314242e-109 6.621991e-108 3.536629e-109 2.250302e-109 #>  [536] 2.940088e-109 5.622246e-109 2.689332e-109 5.125314e-109 2.176657e-109 #>  [541] 1.961029e-109 3.896655e-109 1.960822e-109 6.192239e-109 4.006213e-109 #>  [546] 2.785443e-109 2.646204e-109 5.943231e-109 1.259551e-107 3.351201e-109 #>  [551] 2.869370e-109 2.236388e-109 2.568822e-109 3.615122e-108 1.764030e-106 #>  [556] 2.470793e-109 1.985003e-109 4.703764e-109 3.011271e-109 5.295337e-109 #>  [561] 2.482143e-109 5.432692e-109 2.140484e-109 2.447262e-109 5.939726e-108 #>  [566] 2.149781e-109 5.530340e-109 1.957572e-108 6.492692e-109 2.066573e-109 #>  [571] 1.504796e-108 6.930928e-109 2.329456e-109 2.384048e-109 4.479072e-109 #>  [576] 2.077816e-109 5.150941e-109 3.694288e-109 4.100744e-109 1.969471e-109 #>  [581] 4.096118e-109 5.182882e-109 3.632822e-109 5.289517e-109 3.765604e-109 #>  [586] 1.055951e-108 2.006426e-109 2.718836e-109 2.034469e-109 6.854754e-109 #>  [591] 6.731322e-109 5.236810e-109 5.222168e-109 7.223496e-108 3.104729e-109 #>  [596] 4.740581e-109 3.649926e-109 1.973963e-109 3.012732e-109 1.280185e-108 #>  [601] 1.965136e-109 2.638055e-109 1.273639e-108 2.119148e-109 7.341995e-109 #>  [606] 2.727012e-109 1.977153e-109 1.004815e-108 2.053951e-109 1.140961e-108 #>  [611] 2.053042e-109 2.344434e-106 2.210178e-109 6.451182e-109 1.965540e-109 #>  [616] 3.154978e-109 2.291899e-109 1.459054e-108 9.268156e-109 2.140541e-109 #>  [621] 8.228925e-109 2.597366e-109 2.109502e-109 3.430807e-108 1.509792e-108 #>  [626] 1.247513e-108 3.157832e-109 6.782217e-109 3.136744e-109 1.980872e-109 #>  [631] 1.110694e-108 2.169335e-109 5.207075e-109 2.301895e-109 2.919175e-109 #>  [636] 2.739790e-108 5.709534e-109 2.835608e-109 2.048677e-109 8.486099e-109 #>  [641] 2.301289e-108 1.966741e-109 2.274199e-107 6.686016e-109 2.015936e-109 #>  [646] 2.233201e-109 2.018258e-109 3.040916e-109 4.073318e-109 3.384905e-109 #>  [651] 2.216407e-109 2.121812e-109 3.962775e-109 1.976202e-109 6.449890e-109 #>  [656] 2.573935e-109 2.594864e-109 6.487300e-109 2.015087e-109 2.316533e-109 #>  [661] 8.294012e-109 2.013318e-109 2.575372e-108 2.826551e-109 3.023179e-109 #>  [666] 2.264734e-109 4.386929e-109 2.332277e-109 2.533725e-109 2.879985e-109 #>  [671] 1.024487e-108 1.963574e-109 3.416378e-109 2.056089e-109 2.106935e-109 #>  [676] 2.324030e-109 1.982725e-109 2.799137e-109 1.973301e-109 7.139375e-109 #>  [681] 2.335779e-109 7.150534e-109 4.616950e-109 2.435154e-109 3.694779e-109 #>  [686] 1.413466e-107 3.018572e-109 1.961579e-109 1.339648e-107 3.175320e-109 #>  [691] 1.597506e-108 4.804366e-109 2.006831e-109 2.800127e-109 2.134403e-109 #>  [696] 2.486693e-109 1.960798e-109 1.990640e-109 4.255113e-109 2.569232e-109 #>  [701] 1.067035e-108 9.842653e-109 3.506547e-109 2.663094e-109 2.997204e-109 #>  [706] 8.680404e-109 8.284838e-109 2.519930e-109 4.398422e-109 1.646823e-108 #>  [711] 2.352367e-108 3.363270e-108 2.470481e-109 5.007823e-109 3.333455e-109 #>  [716] 2.082574e-108 5.203295e-109 3.099140e-109 2.481217e-109 7.278084e-109 #>  [721] 2.213048e-109 2.837597e-109 2.313389e-109 2.302361e-108 3.641218e-109 #>  [726] 2.024976e-109 2.725640e-108 1.030469e-107 1.960826e-109 3.222560e-109 #>  [731] 3.373745e-109 1.830334e-107 3.059251e-109 6.804835e-109 7.015341e-109 #>  [736] 2.416063e-109 4.990935e-109 7.283929e-109 4.287563e-109 3.011348e-109 #>  [741] 6.696124e-109 2.194233e-109 2.123759e-109 1.961932e-109 1.018307e-108 #>  [746] 1.527963e-108 2.686193e-109 5.496890e-109 1.230256e-108 2.443630e-109 #>  [751] 4.584018e-109 6.778476e-109 2.226289e-109 2.237416e-109 2.044610e-109 #>  [756] 5.162432e-109 1.641329e-108 5.358255e-108 1.964851e-109 1.289315e-108 #>  [761] 2.006355e-109 2.801213e-109 2.396878e-108 3.736735e-109 1.115602e-108 #>  [766] 4.926197e-108 3.159234e-109 6.097461e-109 3.008671e-109 2.192901e-109 #>  [771] 9.226303e-109 4.565151e-109 3.264020e-109 1.240541e-107 2.043169e-109 #>  [776] 1.960903e-109 3.198356e-109 4.235337e-109 4.529154e-109 3.835080e-109 #>  [781] 2.330573e-109 2.812726e-109 4.394364e-109 3.214757e-109 1.318845e-108 #>  [786] 2.069638e-109 3.907214e-109 2.207616e-109 9.444761e-109 1.973898e-109 #>  [791] 4.067852e-109 5.165596e-109 6.286929e-108 1.967735e-109 8.994980e-109 #>  [796] 2.139335e-109 7.479541e-109 1.630570e-108 2.669953e-108 5.546984e-109 #>  [801] 2.196259e-109 2.786633e-108 2.818076e-109 3.704276e-109 2.079102e-109 #>  [806] 2.525799e-109 2.431230e-109 2.134244e-109 8.841216e-109 1.844474e-108 #>  [811] 2.744635e-109 9.487620e-109 6.535119e-109 3.210713e-109 4.588724e-109 #>  [816] 2.029494e-109 3.713084e-109 4.339590e-108 2.131728e-109 1.657312e-108 #>  [821] 7.634208e-109 8.757432e-109 2.086831e-109 5.302868e-109 5.053578e-109 #>  [826] 4.865613e-109 1.990658e-109 2.189755e-109 1.975904e-109 2.226910e-109 #>  [831] 6.119647e-109 6.827922e-109 1.542649e-108 3.338218e-109 1.988182e-109 #>  [836] 2.086505e-109 2.570074e-109 2.658195e-109 6.385402e-109 3.258957e-109 #>  [841] 4.053824e-109 3.936031e-109 3.829382e-109 3.199652e-109 6.442196e-109 #>  [846] 3.499266e-109 2.025642e-109 3.931583e-109 3.950668e-109 1.982554e-109 #>  [851] 2.112212e-109 1.662691e-108 1.976540e-109 3.933852e-109 2.185944e-109 #>  [856] 1.411296e-108 1.991673e-109 2.301379e-109 3.948415e-109 7.930993e-109 #>  [861] 4.661036e-109 2.007645e-109 1.636239e-108 2.010017e-109 3.683944e-109 #>  [866] 5.848789e-109 9.797956e-109 2.200874e-109 3.402363e-109 6.143183e-109 #>  [871] 2.072638e-109 4.251982e-109 9.038933e-109 3.827022e-109 3.017425e-109 #>  [876] 2.425560e-109 7.780798e-109 2.921925e-108 2.046561e-109 1.991406e-109 #>  [881] 5.894034e-109 3.362672e-109 9.397058e-109 2.180230e-109 5.268742e-109 #>  [886] 1.982951e-109 4.062095e-109 1.985416e-109 2.117899e-109 2.453407e-109 #>  [891] 1.193556e-108 2.396822e-109 3.128772e-109 2.006691e-109 1.974107e-109 #>  [896] 3.581975e-109 2.346778e-108 2.362153e-108 5.088843e-109 2.465629e-109 #>  [901] 3.193345e-108 2.942791e-109 9.860767e-109 5.940812e-109 1.011434e-108 #>  [906] 2.602846e-108 4.695103e-109 6.488392e-109 2.757604e-109 3.024874e-109 #>  [911] 2.155945e-109 3.697599e-109 3.315497e-109 8.642036e-109 3.198261e-107 #>  [916] 1.961297e-109 2.130550e-109 1.971795e-109 2.630525e-109 3.566047e-109 #>  [921] 3.741438e-109 3.142361e-109 7.676394e-109 2.065631e-109 2.088154e-109 #>  [926] 1.989146e-109 1.971476e-109 1.990288e-109 2.128100e-109 1.662747e-108 #>  [931] 3.925537e-109 5.358402e-109 6.626341e-109 1.855772e-107 3.216673e-109 #>  [936] 1.972169e-109 3.549057e-109 3.381289e-109 4.243518e-109 6.189428e-109 #>  [941] 2.083230e-109 6.328761e-109 2.004547e-109 2.990343e-109 5.119696e-108 #>  [946] 5.276464e-109 1.813646e-108 2.381800e-109 1.962169e-109 4.166973e-109 #>  [951] 2.191947e-109 5.535772e-109 2.463681e-109 2.857233e-109 2.667457e-109 #>  [956] 2.021746e-109 2.520095e-109 1.961378e-109 1.795608e-108 5.854734e-109 #>  [961] 1.143401e-108 3.814583e-109 3.831694e-109 6.422200e-109 1.988334e-108 #>  [966] 1.980416e-109 2.996192e-107 1.986438e-109 2.059446e-109 2.104048e-109 #>  [971] 2.184950e-109 2.126620e-109 2.014942e-109 1.840820e-108 7.499020e-109 #>  [976] 3.384696e-109 1.005339e-107 1.972082e-109 2.845878e-109 1.193667e-108 #>  [981] 2.475915e-109 7.680753e-109 2.153140e-109 1.114040e-108 2.355389e-109 #>  [986] 1.995344e-109 2.789190e-109 2.303000e-109 3.550403e-109 7.142855e-109 #>  [991] 2.861791e-109 3.452192e-109 5.975449e-108 1.166951e-108 1.966778e-109 #>  [996] 1.040156e-107 2.365352e-109 3.957772e-109 2.902790e-109 3.467429e-108 susie_get_niter(s) #> [1] 4 susie_get_pip(s) #>    [1] 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>   [38] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>   [75] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [112] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [149] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [186] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [223] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [260] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [297] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [334] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [371] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [408] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [445] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [482] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [519] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [556] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [593] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [630] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [667] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [704] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [741] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [778] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [815] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [852] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [889] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [926] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #>  [963] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #> [1000] 0 susie_get_lfsr(s) #>  [1] 0.0 0.0 0.0 0.0 0.2 0.2 0.2 0.2 0.2 0.2"},{"path":"https://stephenslab.github.io/susieR/reference/susie_init_coef.html","id":null,"dir":"Reference","previous_headings":"","what":"Initialize a susie object using regression coefficients — susie_init_coef","title":"Initialize a susie object using regression coefficients — susie_init_coef","text":"Initialize susie object using regression coefficients","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_init_coef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Initialize a susie object using regression coefficients — susie_init_coef","text":"","code":"susie_init_coef(coef_index, coef_value, p)"},{"path":"https://stephenslab.github.io/susieR/reference/susie_init_coef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Initialize a susie object using regression coefficients — susie_init_coef","text":"coef_index L-vector containing indices nonzero coefficients. coef_value L-vector containing initial coefficient estimates. p scalar giving number variables.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_init_coef.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Initialize a susie object using regression coefficients — susie_init_coef","text":"list elements alpha, mu mu2   used susie.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_init_coef.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Initialize a susie object using regression coefficients — susie_init_coef","text":"","code":"set.seed(1) n = 1000 p = 1000 beta = rep(0,p) beta[sample(1:1000,4)] = 1 X = matrix(rnorm(n*p),nrow = n,ncol = p) X = scale(X,center = TRUE,scale = TRUE) y = drop(X %*% beta + rnorm(n))  # Initialize susie to ground-truth coefficients. s = susie_init_coef(which(beta != 0),beta[beta != 0],length(beta)) res = susie(X,y,L = 10,s_init=s) #> Specified number of effects L = 10 is greater the number of effects 4 in input SuSiE model. The SuSiE model will be expanded to have 10 effects."},{"path":"https://stephenslab.github.io/susieR/reference/susie_plot_changepoint.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot changepoint data and susie fit using ggplot2 — susie_plot_changepoint","title":"Plot changepoint data and susie fit using ggplot2 — susie_plot_changepoint","text":"Plots original data, y, overlaid line showing   susie fitted value shaded rectangles showing credible sets   changepoint locations.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_plot_changepoint.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot changepoint data and susie fit using ggplot2 — susie_plot_changepoint","text":"","code":"susie_plot_changepoint(   s,   y,   line_col = \"blue\",   line_size = 1.5,   cs_col = \"red\" )"},{"path":"https://stephenslab.github.io/susieR/reference/susie_plot_changepoint.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot changepoint data and susie fit using ggplot2 — susie_plot_changepoint","text":"s susie fit generated susie_trendfilter(y,order = 0). y n-vector observations ordered time space (assumed equally-spaced). line_col Color line showing fitted values. line_size Size lines showing fitted values cs_col Color shaded rectangles showing credible sets.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_plot_changepoint.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot changepoint data and susie fit using ggplot2 — susie_plot_changepoint","text":"ggplot2 plot object.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_plot_changepoint.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot changepoint data and susie fit using ggplot2 — susie_plot_changepoint","text":"","code":"set.seed(1) mu = c(rep(0,50),rep(1,50),rep(3,50),rep(-2,50),rep(0,300)) y = mu + rnorm(500) # Here we use a less sensitive tolerance so that the example takes # less time; in practice you will likely want to use a more stringent # setting such as tol = 0.001. s = susie_trendfilter(y,tol = 0.1)  # Produces ggplot with credible sets for changepoints. susie_plot_changepoint(s,y)"},{"path":"https://stephenslab.github.io/susieR/reference/susie_plots.html","id":null,"dir":"Reference","previous_headings":"","what":"SuSiE Plots. — susie_plot","title":"SuSiE Plots. — susie_plot","text":"susie_plot produces per-variable summary   SuSiE credible sets. susie_plot_iteration produces   diagnostic plot susie model fitting.   susie_plot_iteration, several plots created   track_fit = TRUE calling susie.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_plots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SuSiE Plots. — susie_plot","text":"","code":"susie_plot(   model,   y,   add_bar = FALSE,   pos = NULL,   b = NULL,   max_cs = 400,   add_legend = NULL,   ... )  susie_plot_iteration(model, L, file_prefix, pos = NULL)"},{"path":"https://stephenslab.github.io/susieR/reference/susie_plots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SuSiE Plots. — susie_plot","text":"model SuSiE fit, typically output susie one variants. suse_plot, susie fit must model$z, model$PIP, may include model$sets. model may also vector z-scores PIPs. y string indicating plot: either \"z_original\" z-scores, \"z\" z-score derived p-values (base-10) log-scale, \"PIP\" posterior inclusion probabilities, \"log10PIP\" posterior inclusion probabiliities (base-10) log-scale. setting, data plotted . add_bar add_bar = TRUE, add horizontal bar signals credible interval. pos Indices variables plot. pos = NULL variables plotted. b simulated data, set b = TRUE highlight \"true\" effects (highlights red). max_cs largest credible set display, either based purity (set max_cs 0 1), based size (set max_cs > 1). add_legend add_legend = TRUE, add legend annotate size purity CS discovered. can also specified location legends added, e.g., add_legend = \"bottomright\" (default location \"topright\"). ... Additional arguments passed plot. L integer specifying number credible sets plot. file_prefix Prefix path output plot file. specified, plot, plots, saved temporary directory generated using tempdir.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_plots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"SuSiE Plots. — susie_plot","text":"Invisibly returns NULL.","code":""},{"path":[]},{"path":"https://stephenslab.github.io/susieR/reference/susie_plots.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SuSiE Plots. — susie_plot","text":"","code":"set.seed(1) n = 1000 p = 1000 beta = rep(0,p) beta[sample(1:1000,4)] = 1 X = matrix(rnorm(n*p),nrow = n,ncol = p) X = scale(X,center = TRUE,scale = TRUE) y = drop(X %*% beta + rnorm(n)) res = susie(X,y,L = 10) susie_plot(res,\"PIP\")  susie_plot(res,\"PIP\",add_bar = TRUE)  susie_plot(res,\"PIP\",add_legend = TRUE)  susie_plot(res,\"PIP\", pos=1:500, add_legend = TRUE)  # Plot selected regions with adjusted x-axis position label res$genomic_position = 1000 + (1:length(res$pip)) susie_plot(res,\"PIP\",add_legend = TRUE,            pos = list(attr = \"genomic_position\",start = 1000,end = 1500))  # True effects are shown in red. susie_plot(res,\"PIP\",b = beta,add_legend = TRUE)   set.seed(1) n = 1000 p = 1000 beta = rep(0,p) beta[sample(1:1000,4)] = 1 X = matrix(rnorm(n*p),nrow = n,ncol = p) X = scale(X,center = TRUE,scale = TRUE) y = drop(X %*% beta + rnorm(n)) res = susie(X,y,L = 10) susie_plot_iteration(res, L=10) #> Iterplot saved to /tmp/RtmpiaJ1tv/susie_plot.pdf"},{"path":"https://stephenslab.github.io/susieR/reference/susie_rss.html","id":null,"dir":"Reference","previous_headings":"","what":"Sum of Single Effects (SuSiE) Regression using Summary Statistics — susie_rss","title":"Sum of Single Effects (SuSiE) Regression using Summary Statistics — susie_rss","text":"susie_rss performs variable selection   sparse Bayesian multiple linear regression \\(Y\\) \\(X\\)   using z-scores standard univariate regression   \\(Y\\) column \\(X\\), estimate, \\(R\\),   correlation matrix columns \\(X\\), optionally,   strongly recommended, sample size n. See   “Details” ways call susie_rss","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_rss.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sum of Single Effects (SuSiE) Regression using Summary Statistics — susie_rss","text":"","code":"susie_rss(   z,   R,   n,   bhat,   shat,   var_y,   z_ld_weight = 0,   estimate_residual_variance = FALSE,   prior_variance = 50,   check_prior = TRUE,   ... )"},{"path":"https://stephenslab.github.io/susieR/reference/susie_rss.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sum of Single Effects (SuSiE) Regression using Summary Statistics — susie_rss","text":"z p-vector z-scores. R p x p correlation matrix. n sample size. bhat Alternative summary data giving estimated effects (vector length p). , together shat, may provided instead z. shat Alternative summary data giving standard errors estimated effects (vector length p). , together bhat, may provided instead z. var_y sample variance y, defined \\(y'y/(n-1)\\). sample variance provided, coefficients (returned coef) computed “standardized” X, y scale. z_ld_weight parameter included backwards compatibility previous versions function, longer recommended set non-zero value. z_ld_weight > 0, matrix R adjusted cov2cor((1-w)*R + w*tcrossprod(z)), w = z_ld_weight. estimate_residual_variance default FALSE, residual variance fixed 1 variance y. -sample LD matrix provided, recommend setting estimate_residual_variance = TRUE. prior_variance prior variance(s) non-zero noncentrality parameterss \\(\\tilde{b}_l\\). either scalar, vector length L. susie_suff_stat option estimate_prior_variance set TRUE (highly recommended) simply provides initial value prior variance. default value 50 simply intended large initial value. Note setting relevant n unknown. n known, relevant option scaled_prior_variance susie_suff_stat. check_prior check_prior = TRUE, checks estimated prior variance becomes unreasonably large (comparing 100 * max(abs(z))^2). ... parameters passed susie_suff_stat.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_rss.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sum of Single Effects (SuSiE) Regression using Summary Statistics — susie_rss","text":"\"susie\" object following   elements: alpha L p matrix posterior inclusion probabilites. mu L p matrix posterior means, conditional   inclusion. mu2 L p matrix posterior second moments,   conditional inclusion. lbf log-Bayes Factor single effect. lbf_variable log-Bayes Factor variable single effect. V Prior variance non-zero elements b. elbo value variational lower bound,   “ELBO” (objective function maximized), achieved   iteration IBSS fitting procedure. sets Credible sets estimated model fit; see   susie_get_cs details. pip vector length p giving (marginal) posterior   inclusion probabilities p covariates. niter Number IBSS iterations performed. converged TRUE FALSE indicating whether   IBSS converged solution within chosen tolerance   level.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_rss.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sum of Single Effects (SuSiE) Regression using Summary Statistics — susie_rss","text":"applications, particularly genetic applications, desired fit regression model (\\(Y = Xb + E\\) say, refer \"original regression model\" ORM) without access actual values \\(Y\\) \\(X\\), given summary statistics. susie_rss assumes availability z-scores standard univariate regression \\(Y\\) column \\(X\\), estimate, \\(R\\), correlation matrix columns \\(X\\) (genetic applications \\(R\\) sometimes called “LD matrix”). inputs z, R sample size n, susie_rss computes PVE-adjusted z-scores z_tilde, calls susie_suff_stat XtX = (n-1)R, Xty =  \\(\\sqrt{n-1} z_tilde\\), yty = n-1, n = n. output effect estimates scale \\(b\\) ORM standardized \\(X\\) \\(y\\). LD matrix R z-scores z computed using matrix \\(X\\), results susie_rss , similar , susie standardized \\(X\\) \\(y\\). Alternatively, user provides n, bhat (univariate OLS estimates regressing \\(y\\) column \\(X\\)), shat (standard errors OLS regressions), -sample correlation matrix \\(R = cov2cor(crossprod(X))\\), variance \\(y\\), results susie_rss susie \\(X\\) \\(y\\). effect estimates scale coefficients \\(b\\) ORM \\(X\\) \\(y\\). rare cases sample size, \\(n\\), unknown, susie_rss calls susie_suff_stat XtX = R Xty = z, residual_variance = 1. underlying assumption performing analysis way sample size large (.e., infinity), /effects small. formally, combines log-likelihood noncentrality parameters, \\(\\tilde{b} = \\sqrt{n} b\\), $$L(\\tilde{b}; z, R) = -(\\tilde{b}'R\\tilde{b} - 2z'\\tilde{b})/2,$$ “susie prior” \\(\\tilde{b}\\); see susie Wang et al (2020) details. case, effect estimates returned susie_rss noncentrality parameter scale. estimate_residual_variance setting FALSE default, recommended LD matrix estimated reference panel. LD matrix R summary statistics z (bhat, shat) computed using matrix \\(X\\), recommend setting estimate_residual_variance = TRUE.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_rss.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sum of Single Effects (SuSiE) Regression using Summary Statistics — susie_rss","text":"G. Wang, . Sarkar, P. Carbonetto M. Stephens (2020). simple new approach variable selection regression, application genetic fine-mapping. Journal Royal Statistical Society, Series B 82, 1273-1300 doi:10.1101/501114 . Y. Zou, P. Carbonetto, G. Wang, G M. Stephens (2022). Fine-mapping summary data “Sum Single Effects” model. PLoS Genetics 18, e1010299. doi:10.1371/journal.pgen.1010299 .","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_rss.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sum of Single Effects (SuSiE) Regression using Summary Statistics — susie_rss","text":"","code":"set.seed(1) n = 1000 p = 1000 beta = rep(0,p) beta[1:4] = 1 X = matrix(rnorm(n*p),nrow = n,ncol = p) X = scale(X,center = TRUE,scale = TRUE) y = drop(X %*% beta + rnorm(n))  input_ss = compute_suff_stat(X,y,standardize = TRUE) ss   = univariate_regression(X,y) R    = with(input_ss,cov2cor(XtX)) zhat = with(ss,betahat/sebetahat) res  = susie_rss(zhat,R, n=n) #> WARNING: XtX is not symmetric; forcing XtX to be symmetric by replacing XtX with (XtX + t(XtX))/2  # Toy example illustrating behaviour susie_rss when the z-scores # are mostly consistent with a non-invertible correlation matrix. # Here the CS should contain both variables, and two PIPs should # be nearly the same. z = c(6,6.01) R = matrix(1,2,2) fit = susie_rss(z,R) #> WARNING: Providing the sample size (n), or even a rough estimate of n, is highly recommended. Without n, the implicit assumption is n is large (Inf) and the effect sizes are small (close to zero). print(fit$sets$cs) #> $L1 #> [1] 1 2 #>  print(fit$pip) #> [1] 0.4854079 0.5145921  # In this second toy example, the only difference is that one # z-score is much larger than the other. Here we expect that the # second PIP will be much larger than the first. z = c(6,7) R = matrix(1,2,2) fit = susie_rss(z,R) #> WARNING: Providing the sample size (n), or even a rough estimate of n, is highly recommended. Without n, the implicit assumption is n is large (Inf) and the effect sizes are small (close to zero). print(fit$sets$cs) #> $L1 #> [1] 2 #>  print(fit$pip) #> [1] 0.001713869 0.998286131"},{"path":"https://stephenslab.github.io/susieR/reference/susie_trendfilter.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply susie to trend filtering (especially changepoint problems), a type of non-parametric regression. — susie_trendfilter","title":"Apply susie to trend filtering (especially changepoint problems), a type of non-parametric regression. — susie_trendfilter","text":"Fits non-parametric Gaussian regression model   \\(y = mu + e\\), mean \\(mu\\) modelled \\(mu =   Xb\\), X matrix columns containing appropriate basis,   b vector (sparse) SuSiE prior. particular,   order = 0, jth column X vector first j   elements equal zero, remaining elements equal 1,   \\(b_j\\) corresponds change mean y   indices j j+1. background trend filtering, see   Tibshirani (2014). See also \"Trend filtering\" vignette,   vignette(\"trend_filtering\").","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_trendfilter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply susie to trend filtering (especially changepoint problems), a type of non-parametric regression. — susie_trendfilter","text":"","code":"susie_trendfilter(y, order = 0, standardize = FALSE, use_mad = TRUE, ...)"},{"path":"https://stephenslab.github.io/susieR/reference/susie_trendfilter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply susie to trend filtering (especially changepoint problems), a type of non-parametric regression. — susie_trendfilter","text":"y n-vector observations ordered time space (assumed equally spaced). order integer specifying order trend filtering. default, order = 0, corresponds \"changepoint\" problems (.e., piecewise constant \\(mu\\)). Although order > 0 implemented, recommend use; practice, found problems convergence algorithm poor local optima, producing unreliable inferences. standardize Logical indicating whether standardize X variables (\"basis functions\"); standardize = FALSE recommended basis functions already natural scale. use_mad Logical indicating whether use \"median absolute deviation\" (MAD) method estimate residual variance. use_mad = TRUE, susie run twice, first fixing residual variance MAD value, second time, initialized first fit, residual variance estimated usual way (maximizing ELBO). found strategy typically improves reliability results reducing tendency converge poor local optima ELBO. ... arguments passed susie.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_trendfilter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply susie to trend filtering (especially changepoint problems), a type of non-parametric regression. — susie_trendfilter","text":"\"susie\" fit; see susie details.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_trendfilter.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Apply susie to trend filtering (especially changepoint problems), a type of non-parametric regression. — susie_trendfilter","text":"implementation exploits special structure X,   means matrix-vector product \\(X^Ty\\) fast   compute; particular, computation time \\(O(n)\\) rather   \\(O(n^2)\\) X formed explicitly.   implementation details, see \"Implementation SuSiE trend   filtering\" vignette running   vignette(\"trendfiltering_derivations\").","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_trendfilter.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Apply susie to trend filtering (especially changepoint problems), a type of non-parametric regression. — susie_trendfilter","text":"R. J. Tibshirani (2014). Adaptive piecewise polynomial   estimation via trend filtering. Annals Statistics   42, 285-323.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/susie_trendfilter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Apply susie to trend filtering (especially changepoint problems), a type of non-parametric regression. — susie_trendfilter","text":"","code":"set.seed(1) mu = c(rep(0,50),rep(1,50),rep(3,50),rep(-2,50),rep(0,200)) y = mu + rnorm(400) s = susie_trendfilter(y) plot(y) lines(mu,col = 1,lwd = 3) lines(predict(s),col = 2,lwd = 2)   # Calculate credible sets (indices of y that occur just before # changepoints). susie_get_cs(s) #> $cs #> $cs$L1 #> [1] 150 #>  #> $cs$L2 #>  [1] 45 46 47 48 49 50 51 52 53 54 55 #>  #> $cs$L4 #> [1] 199 200 201 #>  #> $cs$L6 #> [1]  99 100 101 102 #>  #>  #> $coverage #> [1] 0.9882895 0.9608400 0.9866788 0.9584016 #>  #> $requested_coverage #> [1] 0.95 #>   # Plot with credible sets for changepoints. susie_plot_changepoint(s,y)"},{"path":"https://stephenslab.github.io/susieR/reference/univariate_regression.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform Univariate Linear Regression Separately for Columns of X — univariate_regression","title":"Perform Univariate Linear Regression Separately for Columns of X — univariate_regression","text":"function performs univariate linear   regression y ~ x separately column x X. regression   implemented using .lm.fit(). estimated effect size   stardard error variable outputted.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/univariate_regression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform Univariate Linear Regression Separately for Columns of X — univariate_regression","text":"","code":"univariate_regression(   X,   y,   Z = NULL,   center = TRUE,   scale = FALSE,   return_residuals = FALSE )"},{"path":"https://stephenslab.github.io/susieR/reference/univariate_regression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform Univariate Linear Regression Separately for Columns of X — univariate_regression","text":"X n p matrix regressors. y n-vector response variables. Z Optional n k matrix covariates included regresions. Z NULL, linear effects covariates removed y first, resulting residuals used place y. center center = TRUE, center X, y Z. scale scale = TRUE, scale X, y Z. return_residuals Whether output residuals Z NULL.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/univariate_regression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform Univariate Linear Regression Separately for Columns of X — univariate_regression","text":"list two vectors containing least-squares   estimates coefficients (betahat) standard   errors (sebetahat). Optionally, matrix   covariates Z provided, third vector residuals   containing residuals returned.","code":""},{"path":"https://stephenslab.github.io/susieR/reference/univariate_regression.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Perform Univariate Linear Regression Separately for Columns of X — univariate_regression","text":"","code":"set.seed(1) n = 1000 p = 1000 beta = rep(0,p) beta[1:4] = 1 X = matrix(rnorm(n*p),nrow = n,ncol = p) X = scale(X,center = TRUE,scale = TRUE) y = drop(X %*% beta + rnorm(n)) res = univariate_regression(X,y) plot(res$betahat/res$sebetahat)"}]
